

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Laboratory 8: Solution of the Quasi-geostrophic Equations &mdash; Numeric course 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide_output div.cell_output, .tag_hide_cell.cell';</script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/mystnb.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> Numeric course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../course_bootstrap.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../ugradsyllabus20.html">Undergrad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../gradsyllabus20.html">Grad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../schedule20.html">Detailed Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../texts.html">Optional texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../notebook_toc.html">Course/lab descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../week_notes.html">Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../assignments.html">Weekly assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../quizzes.html">Quizzes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../rubrics.html">Rubrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../solutions.html">Solutions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">Numeric course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
      <li>Laboratory 8:  Solution of the Quasi-geostrophic Equations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/jupyter_execute/jupyter_execute/jupyter_execute/jupyter_execute/doc_notebooks/lab8/01-lab_8.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="laboratory-8-solution-of-the-quasi-geostrophic-equations">
<h1>Laboratory 8:  Solution of the Quasi-geostrophic Equations<a class="headerlink" href="#laboratory-8-solution-of-the-quasi-geostrophic-equations" title="Permalink to this headline">¶</a></h1>
<p>Lin Yang &amp; John M. Stockie</p>
<div class="section" id="list-of-problems">
<h2>List of Problems<a class="headerlink" href="#list-of-problems" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Problem-One">Problem 1:</a> Discretization of the Jacobian term</p></li>
<li><p><a class="reference external" href="#Problem-Two">Problem 2:</a> Numerical instability in the “straightforward” Jacobian</p></li>
<li><p><a class="reference external" href="#Problem-Three">Problem 3:</a> Implement the SOR relaxation</p></li>
<li><p><a class="reference external" href="#Problem-Four">Problem 4:</a> No-slip boundary conditions</p></li>
<li><p><a class="reference external" href="#Problem-Five">Problem 5:</a> Starting values for the time integration</p></li>
<li><p><a class="reference external" href="#Problem-Six">Problem 6:</a> Duplication of classical results</p></li>
</ul>
</div>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<p>This lab is an introduction to the use of implicit schemes for the
solution of PDE’s, using as an example the quasi-geostrophic equations
that govern the large-scale circulation of the oceans.</p>
<p>You will see that the discretization of the governing equations leads to
a large, sparse system of linear equations. The resulting matrix problem
is solved with relaxation methods, one of which you will write the code
for, by modifying the simpler Jacobi relaxation. There are two types of
boundary conditions typically used for this problem, one of which you
will program yourself – your computations are easily compared to
previously-obtained “classical” results.</p>
</div>
<div class="section" id="readings">
<h2>Readings<a class="headerlink" href="#readings" title="Permalink to this headline">¶</a></h2>
<p>There are no required readings for this lab. If you would like some
additional background beyond the material in the lab itself, then you
may refer to the references listed below:</p>
<ul class="simple">
<li><p><strong>Equations of motion:</strong></p>
<ul>
<li><p><a class="reference external" href="#Ref:Pedlosky">Pedlosky</a> Sections 4.6 &amp; 4.11 (derivation of QG
equations)</p></li>
</ul>
</li>
<li><p><strong>Nonlinear instability:</strong></p>
<ul>
<li><p><a class="reference external" href="#Ref:MesingerArakawa">Mesinger &amp; Arakawa</a> (classic paper with
description of instability and aliasing)</p></li>
<li><p><a class="reference external" href="#Ref:ArakawaLamb">Arakawa &amp; Lamb</a> (non-linear instability in the QG
equations, with the Arakawa-Jacobian)</p></li>
</ul>
</li>
<li><p><strong>Numerical methods:</strong></p>
<ul>
<li><p><a class="reference external" href="#Ref:Strang">Strang</a> (analysis of implicit schemes)</p></li>
<li><p><a class="reference external" href="#Ref:McCalpin">McCalpin</a> (QGbox model)</p></li>
</ul>
</li>
<li><p><strong>Classical numerical results:</strong></p>
<ul>
<li><p><a class="reference external" href="#Ref:Veronis">Veronis</a> (numerical results)</p></li>
<li><p><a class="reference external" href="#Ref:Bryan">Bryan</a> (numerical results)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">context</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="c1"># import the quiz script</span>
<span class="kn">from</span> <span class="nn">numlabs.lab8</span> <span class="kn">import</span> <span class="n">quiz8</span> <span class="k">as</span> <span class="n">quiz</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>******************************
context imported. Front of path:
/Users/phil/repos/numeric
back of path: /Users/phil/.ipython
******************************

through /Users/phil/repos/numeric/notebooks/lab8/context.py
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>An important aspect in the study of large-scale circulation in the ocean
is the response of the ocean to wind stress. Solution of this problem
using the full Navier-Stokes equations is quite complicated, and it is
natural to look for some way to simplify the governing equations. A
common simplification in many models of large-scale, wind-driven ocean
circulation, is to assume a system that is homogeneous and barotropic.</p>
<p>It is now natural to ask:</p>
<blockquote>
<div><p><em>Does the simplified model capture the important dynamics in the
real ocean?</em></p>
</div></blockquote>
<p>This question can be investigated by solving the equations numerically,
and comparing the results to observations in the real ocean. Many
numerical results are already available, and so the purpose of this lab
is to introduce you to the numerical methods used to solve this problem,
and to compare the computed results to those from some classical papers
on numerical ocean simulations.</p>
<p>Some of the numerical details (in Sections <a class="reference external" href="#Right-Hand-Side">Right Hand Side</a>, <a class="reference external" href="#Boundary-Conditions">Boundary Conditions</a>, <a class="reference external" href="#Matrix-Form-of-the-Discrete-Equations">Matrix Form of Discrete Equations</a>, <a class="reference external" href="#Solution-of-the-Poisson-Equation-by-Relaxation">Solution of the Poisson Equation by Relaxation</a>
and the
appendices) are quite technical, and may be passed over the first time
you read through the lab. You can get a general idea of the basic
solution procedure without them. However, you should return to them
later and understand the material contained in them, since these
sections contain techniques that are commonly encountered when solving
PDE’s, and an understanding of these sections is required for you to
answer the problems in the Lab.</p>
</div>
<div class="section" id="the-quasi-geostrophic-model">
<h2>The Quasi-Geostrophic Model<a class="headerlink" href="#the-quasi-geostrophic-model" title="Permalink to this headline">¶</a></h2>
<p>Consider a rectangular ocean with a flat bottom, as pictured in
<a class="reference external" href="#Figure-Model-Ocean">Figure Model Ocean</a>, and ignore curvature effects, by confining the region of interest to a <em>mid-latitude <span class="math notranslate nohighlight">\(\beta\)</span>-plane</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/rect.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;45%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_7_0.png" src="../../../../../../_images/01-lab_8_7_0.png" />
</div>
</div>
<div id='Figure-Model-Ocean'>
**Figure Model Ocean.** The rectangular ocean with flat bottom, ignoring curvature
effects.
</div><p>More information on what is a <span class="math notranslate nohighlight">\(\beta\)</span>-plane and on the neglect of
curvature terms in the <span class="math notranslate nohighlight">\(\beta\)</span>-plane approximation is given in the
appendix.</p>
<p>If we assume that the ocean is homogeneous (it has constant density
throughout), then the equations governing the fluid motion on the
<span class="math notranslate nohighlight">\(\beta\)</span>-plane are:</p>
<div id="eq:xmom">(X-Momentum Eqn)</div><p>\begin{equation}
\frac{\partial u}{\partial t} + u \frac {\partial u}{\partial x} + v \frac {\partial u}{\partial y} + w \frac{\partial u}{\partial z} - fv = - , \frac{1}{\rho} , \frac {\partial p}{\partial x}</p>
<ul class="simple">
<li><p>A_v , \frac{\partial^2 u}{\partial z^2} + A_h , \nabla^2 u
\end{equation}</p></li>
</ul>
<div id="eq:ymom">(Y-Momentum Eqn)</div><p>\begin{equation}
\frac{\partial v}{\partial t} + u \frac{\partial v}{\partial x} + v \frac{\partial v}{\partial y} + w \frac{\partial v}{\partial z} + fu = - , \frac{1}{\rho} , \frac{\partial p}{\partial y}</p>
<ul class="simple">
<li><p>A_v , \frac{\partial^2 v}{\partial z^2} + A_h , \nabla^2 v
\end{equation}</p></li>
</ul>
<div id="eq:hydrostatic">(Hydrostatic Eqn)</div><p>\begin{equation}
\frac{\partial p}{\partial z} = - \rho g
\end{equation}</p>
<div id="eq:continuity">(Continuity Eqn)</div><p>\begin{equation}
\frac {\partial u}{\partial x} + \frac{\partial v}{\partial y} = - , \frac{\partial w}{\partial z}
\end{equation}</p>
<p>where</p>
<ul class="simple">
<li><p>(<a class="reference external" href="#eq:xmom">X-Momentum Eqn</a>) and (<a class="reference external" href="#eq:ymom">Y-Momentum Eqn</a>) are the lateral momentum equations,</p></li>
<li><p>(<a class="reference external" href="#eq:hydrostatic">Hydrostatic Eqn</a>) is the hydrostatic balance (and replaces the vertical momentum
equation), and</p></li>
<li><p>(<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) is the continuity (or incompressibility or conservation of volume) condition.</p></li>
</ul>
<p>The variables and parameters appearing above are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((u,v,w)\)</span>, the fluid velocity components;</p></li>
<li><p><span class="math notranslate nohighlight">\(f(y)\)</span>, the Coriolis parameter (assumed to be a linear function of
<span class="math notranslate nohighlight">\(y\)</span>);</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho\)</span>, the density (assumed constant for a homogeneous fluid);</p></li>
<li><p><span class="math notranslate nohighlight">\(A_v\)</span> and <span class="math notranslate nohighlight">\(A_h\)</span>, the vertical and horizontal coefficients of
viscosity, respectively (constants);</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span>, the gravitational acceleration (constant).</p></li>
</ul>
<p>Equations (<a class="reference external" href="#eq:xmom">X-Momentum Eqn</a>), (<a class="reference external" href="#eq:ymom">Y-Momentum Eqn</a>), (<a class="reference external" href="#eq:hydrostatic">Hydrostatic Eqn</a>) and (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) form a non-linear system of PDE’s, for which there are many
numerical methods available. However, due to the complexity of the
equations, the methods themselves are <em>very complex</em>, and
consume a large amount of CPU time. It is therefore advantageous for us
to reduce the equations to a simpler form, for which common, and more
efficient numerical solution techniques can be used.</p>
<p>By applying a sequence of physically-motivated approximations (see
<a class="reference external" href="#Simplification-of-the-QG-Model-Equations]">Appendix Simplification of the QG Model Equations</a>) and by using the boundary conditions, the system(<a class="reference external" href="#eq:xmom">X-Momentum Eqn</a>), (<a class="reference external" href="#eq:ymom">Y-Momentum Eqn</a>), (<a class="reference external" href="#eq:hydrostatic">Hydrostatic Eqn</a>) and (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) can be
reduced to a single PDE:</p>
<div id='eq:quasi'>
(Quasi-Geotrophic Eqn)
$$
  \frac{\partial}{\partial t} \, \nabla_h^2 \psi + {\cal J} \left( \psi, \nabla_h^2 \psi \right)
  + \beta \, \frac {\partial \psi}{\partial x} = \frac{1}{\rho H} \, \nabla_h \times \tau - \kappa
  \, \nabla_h^2 \psi + A_h \, \nabla_h^4 \psi $$
</div>  <p>where</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\psi\)</span> is the stream function, defined by
<div class="math notranslate nohighlight">
\[u = - \frac{\partial \psi}{\partial y},\]</div>

<div class="math notranslate nohighlight">
\[v = \frac{\partial \psi}{\partial x}\]</div>
</p></li>
<li><p><div class="math notranslate nohighlight">
\[\nabla_h = \left(\frac{\partial}{\partial x},\frac{\partial}{\partial y}\right)\]</div>

is the “horizontal”
gradient operator, so-called because it involves only derivatives in
<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>;</p></li>
<li><p><div class="math notranslate nohighlight">
\[{\cal J} (a,b) = \frac{\partial a}{\partial x}  \frac{\partial
b}{\partial y} - \frac{\partial a}{\partial y} \frac{\partial b}{\partial x}\]</div>
<br />
is the <em>Jacobian</em> operator;</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{\tau}(x,y) = \left(\,\tau_1(x,y),\tau_2(x,y)\,\right)\)</span> is the
wind stress boundary condition at the surface <span class="math notranslate nohighlight">\(z=0\)</span>. A simple form
of the wind stress might assume an ocean “box” that extends from
near the equator to a latitude of about <span class="math notranslate nohighlight">\(60^\circ\)</span>, for which
typical winds are easterly near the equator and turn westerly at
middle latitudes. A simple function describing this is
<div class="math notranslate nohighlight">
\[\vec{\tau} = \tau_{max} (-\cos y, 0),\]</div>

which is what we will use in this lab.</p>
<p>More complicated wind stress functions are possible. See <a class="reference external" href="#Ref:McCalpin">McCalpin’s</a>
QGBOX documentation [p. 24] for another
example.</p>
</li>
</ul>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta = df/dy\)</span> is a constant, where <span class="math notranslate nohighlight">\(f(y) = f_0+\beta y\)</span> (see
<a class="reference external" href="#Definition-of-the-Beta-plane">Appendix Definition of the Beta-plane</a>);</p></li>
<li><p><span class="math notranslate nohighlight">\(\kappa = {1}/{H}  \left[ (A_v f_0)/{2} \right]^{1/2}\)</span> is the bottom friction scaling (constant); and</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> is the vertical depth of the water column (constant).</p></li>
</ul>
<p>Notice that the original (second order) system of four equations in four
unknowns (<span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(w\)</span>, <span class="math notranslate nohighlight">\(p\)</span>) has now been reduced to a single (fourth
order) PDE in one unknown function, <span class="math notranslate nohighlight">\(\psi\)</span>. It will become clear in the
next section just how much simpler the system of equations has become …</p>
<p>Before going on, though, we need to close the system with the
<em>boundary conditions</em> for the stream function <span class="math notranslate nohighlight">\(\psi\)</span>. We
must actually consider two cases, based on whether or not the lateral
eddy viscosity parameter, <span class="math notranslate nohighlight">\(A_h\)</span>, is zero:</p>
<ul class="simple">
<li><p><strong>if <span class="math notranslate nohighlight">\(A_h=0\)</span>:</strong> the boundary conditions are
<em>free-slip</em>; that is, <span class="math notranslate nohighlight">\(\psi=0\)</span> on the boundary.</p></li>
<li><p><strong>if <span class="math notranslate nohighlight">\(A_h\neq 0\)</span>:</strong> the boundary conditions are
<em>no-slip</em>; that is both <span class="math notranslate nohighlight">\(\psi\)</span> and its normal
derivative <span class="math notranslate nohighlight">\(\nabla\psi\cdot\hat{n}\)</span> are zero on the boundary (where
<span class="math notranslate nohighlight">\(\hat{n}\)</span> is the normal vector to the boundary).</p></li>
</ul>
<div class="section" id="scaling-the-equations-of-motion">
<h3>Scaling the Equations of Motion<a class="headerlink" href="#scaling-the-equations-of-motion" title="Permalink to this headline">¶</a></h3>
<p>In physical problems, it is not uncommon for some of the quantities of
interest to differ in size by many orders of magnitude. This is of
particular concern when computing numerical solutions to such problems,
since then round-off errors can begin to pollute the computations (see
Lab 2).</p>
<p>This is also the case for the QG equations, where the parameters have a
large variation in size. The QG model parameters, and typical numerical
values, are given in <a class="reference external" href="#tab:parameters">Table of Parameters</a>. For such problems it is customary to <em>rescale</em> the
variables in such a way that the size differences are minimized.</p>
<p><strong>Problem Parameters</strong></p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Name</th>
<th class="head">Range of Magnitude</th>
<th class="head">Units</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(R\)</span></td>
<td>Earth’s radius</td>
<td><span class="math notranslate nohighlight">\(6.4 \times 10^6\)</span></td>
<td><span class="math notranslate nohighlight">\(m\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\Omega\)</span></td>
<td>Angular frequency for Earth</td>
<td><span class="math notranslate nohighlight">\(7.27 \times 10^{-5}\)</span></td>
<td><span class="math notranslate nohighlight">\(s^{-1}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(H\)</span></td>
<td>Depth of active layer</td>
<td><span class="math notranslate nohighlight">\(100 \rightarrow 4000\)</span></td>
<td><span class="math notranslate nohighlight">\(m\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(B\)</span></td>
<td>Length and width of ocean</td>
<td><span class="math notranslate nohighlight">\(1.0 \rightarrow 5.0 \times 10^6\)</span></td>
<td><span class="math notranslate nohighlight">\(m\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\rho\)</span></td>
<td>Density of water</td>
<td><span class="math notranslate nohighlight">\(10^3\)</span></td>
<td><span class="math notranslate nohighlight">\(kg/m^3\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(A_h\)</span></td>
<td>Lateral eddy viscosity</td>
<td><span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(10^1 \rightarrow 10^4\)</span></td>
<td><span class="math notranslate nohighlight">\(m^2/s\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(A_v\)</span></td>
<td>Vertical eddy viscosity</td>
<td><span class="math notranslate nohighlight">\(10^{-4} \rightarrow 10^{-1}\)</span></td>
<td><span class="math notranslate nohighlight">\(m^2/s\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\tau_{max}\)</span></td>
<td>Maximum wind stress</td>
<td><span class="math notranslate nohighlight">\(10^{-2} \rightarrow 1\)</span></td>
<td><span class="math notranslate nohighlight">\(kg m^{-1} s^{-2}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\theta_0\)</span></td>
<td>Latitude</td>
<td><span class="math notranslate nohighlight">\(0 \rightarrow \frac{\pi}{3}\)</span></td>
<td>-</td>
</tr>
</tbody>
</table>
<p><strong>Derived Quantities</strong></p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Name</th>
<th class="head">Range of Magnitude</th>
<th class="head">Units</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\beta\)</span></td>
<td><span class="math notranslate nohighlight">\(\beta =2\Omega \cos \theta_0 / R\)</span></td>
<td><span class="math notranslate nohighlight">\(1.1 \rightarrow 2.3 \times 10^{-11}\)</span></td>
<td><span class="math notranslate nohighlight">\(m^{-1} s^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(f_0\)</span></td>
<td><span class="math notranslate nohighlight">\(f_0 = 2 \Omega \sin \theta_0\)</span></td>
<td><span class="math notranslate nohighlight">\(0.0 \rightarrow 1.3 \times 10^{-4}\)</span></td>
<td><span class="math notranslate nohighlight">\(s^{-1}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(U_0\)</span></td>
<td>Velocity scale = <span class="math notranslate nohighlight">\(\tau_{max}/(\beta\rho H B)\)</span></td>
<td><span class="math notranslate nohighlight">\(10^{-5} \rightarrow 10^{-1}\)</span></td>
<td><span class="math notranslate nohighlight">\(m s^{-1}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\kappa\)</span></td>
<td>bottom friction parameter</td>
<td><span class="math notranslate nohighlight">\(0.0 \rightarrow 10^{-5}\)</span></td>
<td><span class="math notranslate nohighlight">\(m^2 s^{-2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Non-dimensional Quantities</strong></p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Symbol / Name</th>
<th class="head">Range of Magnitude for Quantity</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\epsilon\)</span> / Vorticity ratio = <span class="math notranslate nohighlight">\(U_0/(\beta B^2)\)</span></td>
<td>(computed)</td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\frac{\tau_{max}}{\epsilon\beta^2 \rho H B^3}\)</span></td>
<td><span class="math notranslate nohighlight">\(10^{-12} \rightarrow 10^{-14}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\frac{\kappa}{\beta B}\)</span></td>
<td><span class="math notranslate nohighlight">\(4 \times 10^{-4} \rightarrow 6 \times 10^1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\frac{A_h}{\beta B^3}\)</span></td>
<td><span class="math notranslate nohighlight">\(10^{-7} \rightarrow 10^{-4}\)</span></td>
</tr>
</tbody>
</table>
<div id='tab:parameters'>
**Table of Parameters**
</div><p>Let us go through this scaling process for the evolution
equation <a class="reference external" href="#eq:quasi">(Quasi-Geostrophic Eqn)</a> for the stream function, which is reproduced
here for easy comparison:</p>
<p><div class="math notranslate nohighlight">
\[\frac{\partial}{\partial t} \nabla^2_h \psi = - \beta \frac{\partial \psi}{\partial x} - {\cal J}(\psi, \nabla_h^2\psi)+ \frac{1}{\rho H} \nabla_h \times \vec{\tau} - \kappa \nabla_h^2 \psi + A_h \nabla_h^4 \psi\]</div>
</p>
<p>The basic idea is to find typical
<em>scales of motion</em>, and then redefine the dependent and
independent variables in terms of these scales to obtain
<em>dimensionless variables</em>.</p>
<p>For example, the basin width and length, <span class="math notranslate nohighlight">\(B\)</span>, can be used as a scale for
the dependent variables <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. Then, we define dimensionless
variables</p>
<div id='eq:xscale'>
(x-scale eqn)
$$x^\prime = \frac{x}{B}$$
</div><div id='eq:yscale'>
(y-scale eqn)
$$y^\prime = \frac{y}{B}$$
</div><p>Notice that where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> varied between
0 and <span class="math notranslate nohighlight">\(B\)</span> (where <span class="math notranslate nohighlight">\(B\)</span> could be on the order of hundreds of kilometres),
the new variables <span class="math notranslate nohighlight">\(x^\prime\)</span> and <span class="math notranslate nohighlight">\(y^\prime\)</span> now vary between 0 and 1
(and so the ocean is now a unit square).</p>
<p>Similarly, we can redefine the remaining variables in the problem as</p>
<div id='eq:tscale'>
(t-scale eqn)
$$
  t^\prime = \frac{t}{\left(\frac{1}{\beta B}\right)} $$
</div><div id='eq:psiscale'>
($\psi$-scale eqn)
$$  \psi^\prime = \frac{\psi}{\epsilon \beta B^3} $$
</div><div id='eq:tauscale'>
($\tau$-scale eqn)
$$  \vec{\tau}^\prime = \frac{\vec{\tau}}{\tau_{max}}
  $$</div><p>where the scales have been
specially chosen to represent typical sizes of the variables. Here, the
parameter <span class="math notranslate nohighlight">\(\epsilon\)</span> is a measure of the the ratio between the “relative
vorticity” (<span class="math notranslate nohighlight">\(\max|\nabla_h^2 \psi|\)</span>) and the planetary vorticity (given
by <span class="math notranslate nohighlight">\(\beta B\)</span>).</p>
<p>Now, we need only substitute for the original variables in the
equations, and replace derivatives with their dimensionless
counterparts; for example, using the chain rule,
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial x} = \frac{\partial x^\prime}{\partial x}
\frac{\partial}{\partial x^\prime}.\]</div>
 Then the equation of motion
becomes</p>
<p><a name='eq:qg-rescaled'></a>
(Rescaled Quasi-Geostrophic Eqn)
<div class="math notranslate nohighlight">
\[ \frac{\partial}{\partial t^\prime} \nabla^{\prime 2}_h \psi^\prime = - \, \frac{\partial \psi^\prime}{\partial x^\prime} - \epsilon {\cal J^\prime}(\psi^\prime, \nabla_h^{\prime 2}\psi^\prime) + \frac{\tau_{max}}{\epsilon \beta^2 \rho H B^3} \nabla^\prime_h \times \vec{\tau}^\prime - \, \frac{\kappa}{\beta B} \nabla_h^{\prime 2} \psi^\prime + \frac{A_h}{\beta B^3} \nabla_h^{\prime 4} \psi^\prime \]</div>

The superscript
“<span class="math notranslate nohighlight">\(\,^\prime\)</span>” on <span class="math notranslate nohighlight">\(\nabla_h\)</span> and <span class="math notranslate nohighlight">\({\cal J}\)</span> signify that the derivatives
are taken with respect to the dimensionless variables. Notice that each
term in (<a class="reference external" href="#eq:qg-rescaled">Rescaled Quasi-Geostrophic Eqn</a>) is now dimensionless, and that there are
now 4 dimensionless combinations of parameters <div class="math notranslate nohighlight">
\[\epsilon, \;\; 
\frac{\tau_{max}}{\epsilon \beta^2 \rho H B^3}, \;\;
\frac{\kappa}{\beta B}, \;\; \mbox{ and} \;\;
\frac{A_h}{\beta B^3}.\]</div>
 These four expressions define four new
dimensionless parameters that replace the original (unscaled) parameters
in the problem.</p>
<p>The terms in the equation now involve the dimensionless stream function,
<span class="math notranslate nohighlight">\(\psi^\prime\)</span>, and its derivatives, which have been scaled so that they
are now of order 1 in magnitude. The differences in sizes between terms
in the equation are now embodied solely in the four dimensionless
parameters. A term which is multiplied by a small parameter is thus
truly small in comparison to the other terms, and hence additive
round-off errors will not contribute substantially to a numerical
solution based on this form of the equations.</p>
<p>For the remainder of this lab, we will use the scaled version of the
equations. Consequently, the notation will be simplified by dropping the
“primes” on the dimensionless variables. But, <strong>do not
forget</strong>, that any solution (numerical or analytical) from the
scaled equations must be converted back into dimensional variables
using <a class="reference external" href="#eq:xscale">the scale equations</a>.</p>
</div>
</div>
<div class="section" id="discretization-of-the-qg-equations">
<h2>Discretization of the QG equations<a class="headerlink" href="#discretization-of-the-qg-equations" title="Permalink to this headline">¶</a></h2>
<p>At first glance, it is probably not clear how one might discretize the
QG equation (<a class="reference external" href="#eq:qg-rescaled">Rescaled Quasi-Geostrophic Eqn</a>) from the previous section. This equation is an evolution
equation for <span class="math notranslate nohighlight">\(\nabla_h^2 \psi\)</span> (the Laplacian of the stream function)
but has a right hand side that depends not only on <span class="math notranslate nohighlight">\(\nabla_h^2 \psi\)</span>,
but also on <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\nabla_h^4 \psi\)</span>. The problem may be written in
a more suggestive form, by letting <span class="math notranslate nohighlight">\(\chi = \partial\psi/\partial t\)</span>.
Then, the (<a class="reference external" href="#eq:qg-rescaled">Rescaled Quasi-Geostrophic Eqn</a>) becomes</p>
<p><a name='eq:poisson'></a>
(Poisson Eqn)
<div class="math notranslate nohighlight">
\[\nabla_h^2 \chi = F(x,y,t), 
\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(F(x,y,t)\)</span> contains all of the terms
except the time derivative. We will see that the discrete version of
this equation is easily solved for the new unknown variable <span class="math notranslate nohighlight">\(\chi\)</span>,
after which</p>
<div id='eq:dpsidt'>
$$\frac{\partial\psi}{\partial t} = \chi
$$</div><p>may be used to evolve the stream function in
time.</p>
<p>The next two sections discuss the spatial and temporal discretization,
including some details related to the right hand side, the boundary
conditions, and the iterative scheme for solving the large sparse system
of equations that arises from the Poisson equation for <span class="math notranslate nohighlight">\(\chi\)</span>. Following
that is an summary of the steps in the solution procedure.</p>
<div class="section" id="spatial-discretization">
<h3>Spatial Discretization<a class="headerlink" href="#spatial-discretization" title="Permalink to this headline">¶</a></h3>
<p>Assume that we are dealing with a square ocean, with dimensions
<span class="math notranslate nohighlight">\(1\times 1\)</span> (in non-dimensional coordinates) and begin by dividing the
domain into a grid of discrete points
<div class="math notranslate nohighlight">
\[x_i = i \Delta x, \;\;i = 0, 1, 2, \dots, M\]</div>

<div class="math notranslate nohighlight">
\[y_j = j \Delta y, \;\;j = 0, 1, 2, \dots, N\]</div>
 where <span class="math notranslate nohighlight">\(\Delta x = 1/M\)</span>
and <span class="math notranslate nohighlight">\(\Delta y = 1/N\)</span>. In order to simplify the discrete equations, it
will be helpful to assume that <span class="math notranslate nohighlight">\(M=N\)</span>, so that
<span class="math notranslate nohighlight">\(\Delta x = \Delta y \equiv d\)</span>. We can then look for approximate values
of the stream function at the discrete points; that is, we look for
<div class="math notranslate nohighlight">
\[\Psi_{i,j} \approx \psi(x_i,y_j)\]</div>
 (and similarly for <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span>).
The computational grid and placement of unknowns is pictured in
Figure <a class="reference external" href="#Spatial-Grid">Spatial Grid</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/spatial.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;45%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_18_0.png" src="../../../../../../_images/01-lab_8_18_0.png" />
</div>
</div>
<div id='Spatial-Grid'>
**Figure Spatial Grid**
</div><p>Derivatives are replaced by their centered, second-order finite
difference approximations
<div class="math notranslate nohighlight">
\[
\left. \frac{\partial \Psi}{\partial x} \right|_{i,j}
\approx 
\frac{\Psi_{i+1,j}-\Psi_{i-1,j}}{2d}
\left. \frac{\partial^2 \Psi}{\partial x^2} \right|_{i,j} 
\approx
\frac{\Psi_{i+1,j} - 2 \Psi_{i,j} + \Psi_{i-1,j}}{d^2}
\]</div>

and similarly for the
<span class="math notranslate nohighlight">\(y\)</span>-derivatives. The discrete analogue of the (<a class="reference external" href="#eq:poisson">Poisson equation</a>),
centered at the point <span class="math notranslate nohighlight">\((x_i,y_j)\)</span>, may be written as
<div class="math notranslate nohighlight">
\[\frac{\chi_{i+1,j} - 2\chi_{i,j} +\chi_{i-1,j}}{d^2} + 
\frac{\chi_{i,j+1} - 2\chi_{i,j} +\chi_{i,j-1}}{d^2}  = F_{i,j}\]</div>
 or,
after rearranging,</p>
<p><a name='eq:discrete-chi'></a>
(Discrete <span class="math notranslate nohighlight">\(\chi\)</span> Eqn)
<div class="math notranslate nohighlight">
\[\chi_{i+1,j}+\chi_{i-1,j}+\chi_{i,j+1}+\chi_{i,j-1}-4\chi_{i,j} =
d^2F_{i,j}.
\]</div>
</p>
<p>Here, we’ve used
<span class="math notranslate nohighlight">\(F_{i,j} = F(x_i,y_j,t)\)</span> as the values of the right hand side function
at the discrete points, and said nothing of how to discretize <span class="math notranslate nohighlight">\(F\)</span> (this
will be left until <a class="reference external" href="#Right-Hand-Side">Right Hand Side</a>. The (<a class="reference external" href="#eq:discrete-chi">Discrete <span class="math notranslate nohighlight">\(\chi\)</span> equation</a>) is an equation centered at the grid point <span class="math notranslate nohighlight">\((i,j)\)</span>, and relating
the values of the approximate solution, <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span>, at the <span class="math notranslate nohighlight">\((i,j)\)</span>
point, to the four neighbouring values, as described by the <em>5-point difference stencil</em> pictured in
<a class="reference external" href="#fig:stencil">Figure Stencil</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/2diff.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_20_0.png" src="../../../../../../_images/01-lab_8_20_0.png" />
</div>
</div>
<div id='fig:stencil'>
**Figure Stencil:**
The standard 5-point centered difference stencil for the Laplacian
(multiply by $\frac{1}{d^2}$ to get the actual coefficients. </div><p>These stencil diagrams are a compact way of representing the information
contained in finite difference formulas. To see how useful they are, do
the following:</p>
<ul class="simple">
<li><p>Choose the point on the grid in <a class="reference external" href="#Spatial-Grid">Figure Spatial Grid</a> that
you want to apply the difference formula (<a class="reference external" href="#eq:discrete-chi">Discrete <span class="math notranslate nohighlight">\(\chi\)</span> Eqn</a>).</p></li>
<li><p>Overlay the difference stencil diagram on the grid, placing the
center point (with value <span class="math notranslate nohighlight">\(-4\)</span>) on this point.</p></li>
<li><p>The numbers in the stencil are the multiples for each of the
unknowns <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span> in the difference formula.</p></li>
</ul>
<p>An illustration of this is given in <a class="reference external" href="#fig:overlay">Figure Overlay</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/2diffgrid.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_22_0.png" src="../../../../../../_images/01-lab_8_22_0.png" />
</div>
</div>
<div id='fig:overlay'>
**Figure Overlay:**
    The 5-point difference stencil overlaid on the grid.
    </div><p>Before going any further with the discretization, we need to provide a
few more details for the discretization of the right hand side function,
<span class="math notranslate nohighlight">\(F(x,y,t)\)</span>, and the boundary conditions. If you’d rather skip these for
now, and move on to the time discretization
(<a class="reference external" href="#Temporal-Discretization">Section Temporal Discretization</a>)
or the outline of the solution procedure
(<a class="reference external" href="#Outline-of-Solution-Procedure">Section Outline of Solution Procedure</a>), then you may do so now.</p>
<div class="section" id="right-hand-side">
<h4>Right Hand Side<a class="headerlink" href="#right-hand-side" title="Permalink to this headline">¶</a></h4>
<p>The right hand side function for the (<a class="reference external" href="#eq:poisson">Poisson equation</a>) is reproduced here
in scaled form (with the “primes” dropped):
<div class="math notranslate nohighlight">
\[F(x,y,t) = - \, \frac{\partial \psi}{\partial x} - \epsilon {\cal J}(\psi,\nabla_h^{2}\psi) + \frac{\tau_{max}}{\epsilon \beta^2 \rho H B^3} \nabla_h \times \vec{\tau} - \frac{\kappa}{\beta B} \nabla_h^{2} \psi + \frac{A_h}{\beta B^3} \nabla_h^{4} \psi\]</div>
</p>
<p>Alternatively, the Coriolis and Jacobian terms can be grouped together
as a single term:
<div class="math notranslate nohighlight">
\[- \, \frac{\partial\psi}{\partial x} - \epsilon {\cal J}(\psi, \nabla^2_h\psi) = - {\cal J}(\psi, y + \epsilon \nabla^2_h\psi)\]</div>
</p>
<p>Except for the Jacobian term, straightforward second-order centered
differences will suffice for the Coriolis force
<div class="math notranslate nohighlight">
\[\frac{\partial\psi}{\partial x} \approx 
\frac{1}{2d} \left(\Psi_{i+1,j} - \Psi_{i-1,j}\right),\]</div>

the wind
stress
<div class="math notranslate nohighlight">
\[\nabla_h \times \vec{\tau} \approx
\frac{1}{2d} \, 
\left( \tau_{2_{i+1,j}}-\tau_{2_{i-1,j}} - 
\tau_{1_{i,j+1}}+\tau_{1_{i,j-1}} \right),\]</div>
 and the second order
viscosity term <div class="math notranslate nohighlight">
\[\nabla_h^2 \psi \approx
\frac{1}{d^2} \left( \Psi_{i+1,j}+\Psi_{i-1,j}+\Psi_{i,j+1} +
\Psi_{i,j-1} - 4 \Psi_{i,j} \right).\]</div>
</p>
<p>The higher order (biharmonic) viscosity term, <span class="math notranslate nohighlight">\(\nabla_h^4 \psi\)</span>, is
slightly more complicated. The difference stencil can be derived in a
straightforward way by splitting into <span class="math notranslate nohighlight">\(\nabla_h^2 (\nabla_h^2 \psi)\)</span> and
applying the discrete version of the Laplacian operator twice. The
resulting difference formula is</p>
<div id='eq:discrete-d4'>
(Bi-Laplacian)
$$ \nabla_h^4 \psi 
   =  \nabla_h^2 ( \nabla_h^2 \psi ) $$ $$
   \approx  \frac{1}{d^4} \left( \Psi_{i+2,j} + \Psi_{i,j+2} +
    \Psi_{i-2,j} + \Psi_{i,j-2} \right. + \, 2 \Psi_{i+1,j+1} + 2 \Psi_{i+1,j-1} + 2 \Psi_{i-1,j+1} +
    2 \Psi_{i-1,j-1}
   \left. - 8 \Psi_{i,j+1} - 8 \Psi_{i-1,j} - 8 \Psi_{i,j-1} - 8 \, \Psi_{i+1,j} + 20 \Psi_{i,j} \right)
  $$ </div> which is pictured in the
difference stencil in [Figure Bi-Laplacian Stencil](#fig:d4stencil).<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/4diff.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_26_0.png" src="../../../../../../_images/01-lab_8_26_0.png" />
</div>
</div>
<div id='fig:d4stencil'>
**Figure Bi-Laplacian Stencil:**
13-point difference stencil for the centered difference formula for
$\nabla_h^4$ (multiply by $\frac{1}{d^4}$ to get the actual
coefficients).</div><p>The final term is the Jacobian term, <span class="math notranslate nohighlight">\({\cal J}(\psi,
\nabla^2_h\psi)\)</span> which, as you might have already guessed, is the one
that is going to give us the most headaches. To get a feeling for why
this might be true, go back to (<a class="reference external" href="#eq:qg-rescaled">Rescaled Quasi-Geostropic Equation</a>)  and notice that the only
nonlinearity arises from this term. Typically, it is the nonlinearity in
a problem that leads to difficulties in a numerical scheme. Remember the
formula given for <span class="math notranslate nohighlight">\({\cal J}\)</span> in the previous section:</p>
<p><a name='eq:jacob1'></a>
(Jacobian: Expansion 1)
<div class="math notranslate nohighlight">
\[{\cal J}(a,b) = \frac{\partial a}{\partial x} \, \frac{\partial b}{\partial y} - 
\frac{\partial a}{\partial y} \, \frac{\partial b}{\partial x}
\]</div>
</p>
</div>
<div class="section" id="problem-one">
<h4>Problem One<a class="headerlink" href="#problem-one" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Apply the standard centered difference formula
(see Lab 1 if you need to refresh you memory) to get a difference
approximation to the Jacobian based on (<a class="reference external" href="#eq:jacob1">Jacobian: Expansion 1</a>. You will use this later in
<a class="reference external" href="#Problem-Two">Problem Two</a>.</p>
</div></blockquote>
<p>We’ve seen before that there is usually more than one way to discretize
a given expression. This case is no different, and there are many
possible ways to derive a discrete version of the Jacobian. Two other
approaches are to apply centered differences to the following equivalent
forms of the Jacobian:</p>
<div id='eq:jacob2'>
(Jacobian: Expansion 2)
$$
  {\cal J}(a,b) = \frac{\partial}{\partial x} \, \left( a \frac{\partial b}{\partial y} \right) -
    \frac{\partial}{\partial y} \left( a \frac{\partial b}{\partial x} \right)
    $$</div>
<div id='eq:jacob3'>
(Jacobian: Expansion 3)
$$
  {\cal J}(a,b) = \frac{\partial}{\partial y} \, \left( b \frac{\partial a}{\partial x} \right) -
    \frac{\partial}{\partial x} \left( b \frac{\partial a}{\partial y} \right)
    $$
   </div> <p>Each formula leads to a different discrete formula, and we will see in
<a class="reference external" href="#Aliasing-Error-and-Nonlinear-Instability">Section Aliasing Error and Nonlinear Instability</a>
what effect the non-linear term has on
the discrete approximations and how the use of the different formulas
affect the behaviour of the numerical scheme. Before moving on, try to
do the following two quizzes.</p>
</div>
<div class="section" id="quiz-on-jacobian-expansion-2">
<h4>Quiz on Jacobian Expansion #2<a class="headerlink" href="#quiz-on-jacobian-expansion-2" title="Permalink to this headline">¶</a></h4>
<p>Using second order centered differences, what is the discretization of the second form of the Jacobian given by</p>
<p><div class="math notranslate nohighlight">
\[
{\cal J}(a,b) = \frac{\partial}{\partial x} \, \left( a \frac{\partial b}{\partial y} \right) -
\frac{\partial}{\partial y} \left( a \frac{\partial b}{\partial x} \right)
\]</div>
</p>
<ul class="simple">
<li><p>A: <div class="math notranslate nohighlight">
\[\frac 1 {d^2} \left[ \left( a_{i+1,j} - a_{i-1,j} \right) \left( b_{i,j+1} - b_{i,j-1} \right) -    \left( a_{i,j+1} - a_{i,j-1} \right) \left( b_{i+1,j} - b_{i-1,j} \right) \right]\]</div>
</p></li>
<li><p>B: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ a_{i+1,j} \left( b_{i+1,j+1} - b_{i+1,j-1} \right) - a_{i-1,j} \left( b_{i-1,j+1} - b_{i-1,j-1} \right) - a_{i,j+1} \left( b_{i+1,j+1} - b_{i-1,j+1} \right) + a_{i,j-1} \left( b_{i+1,j-1} - b_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>C: <div class="math notranslate nohighlight">
\[\frac 1 {d^2} \left[ \left( a_{i+1/2,j} - a_{i-1/2,j} \right) \left( b_{i,j+1/2} - b_{i,j-1/2} \right) -    \left( a_{i,j+1/2} - a_{i,j-1/2} \right) \left( b_{i+1/2,j} - b_{i-1/2,j} \right) \right]\]</div>
</p></li>
<li><p>D: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ b_{i+1,j} \left( a_{i+1,j+1} - a_{i+1,j-1} \right) - b_{i-1,j} \left( a_{i-1,j+1} - a_{i-1,j-1} \right) - b_{i,j+1} \left( a_{i+1,j+1} - a_{i-1,j+1} \right) + b_{i,j-1} \left( a_{i+1,j-1} - a_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>E: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ a_{i+1,j+1} \left( b_{i+1,j+1} - b_{i+1,j-1} \right) - a_{i-1,j-1} \left( b_{i-1,j+1} - b_{i-1,j-1} \right) - a_{i+1,j+1} \left( b_{i+1,j+1} - b_{i-1,j+1} \right) + a_{i-1,j-1} \left( b_{i+1,j-1} - b_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>F: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ \left( a_{i+1,j} - a_{i-1,j} \right) \left( b_{i,j+1} - b_{i,j-1} \right) -    \left( a_{i,j+1} - a_{i,j-1} \right) \left( b_{i+1,j} - b_{i-1,j} \right) \right]\]</div>
</p></li>
<li><p>G: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ b_{i,j+1} \left( a_{i+1,j+1} - a_{i-1,j+1} \right) - b_{i,j-1} \left( a_{i+1,j-1} - a_{i-1,j-1} \right) - b_{i+1,j} \left( a_{i+1,j+1} - a_{i+1,j-1} \right) + b_{i-1,j} \left( a_{i-1,j+1} - a_{i-1,j-1} \right) \right]\]</div>
</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                       
</pre></div>
</div>
<p>In the following, replace ‘x’ by ‘A’, ‘B’, ‘C’, ‘D’, ‘E’, ‘F’, ‘G’, or ‘Hint’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">quiz</span><span class="o">.</span><span class="n">jacobian_2</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Acceptable answers are &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;Hint&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="quiz-on-jacobian-expansion-3">
<h4>Quiz on Jacobian Expansion #3<a class="headerlink" href="#quiz-on-jacobian-expansion-3" title="Permalink to this headline">¶</a></h4>
<p>Using second order centered differences, what is the discretization of the third form of the Jacobian given by</p>
<p><div class="math notranslate nohighlight">
\[
{\cal J}(a,b) = \frac{\partial}{\partial y} \, \left( b \frac{\partial a}{\partial x} \right) -
\frac{\partial}{\partial x} \left( b \frac{\partial a}{\partial y} \right)
\]</div>
</p>
<ul class="simple">
<li><p>A: - A: <div class="math notranslate nohighlight">
\[\frac 1 {d^2} \left[ \left( a_{i+1,j} - a_{i-1,j} \right) \left( b_{i,j+1} - b_{i,j-1} \right) -    \left( a_{i,j+1} - a_{i,j-1} \right) \left( b_{i+1,j} - b_{i-1,j} \right) \right]\]</div>
</p></li>
<li><p>B: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ a_{i+1,j} \left( b_{i+1,j+1} - b_{i+1,j-1} \right) - a_{i-1,j} \left( b_{i-1,j+1} - b_{i-1,j-1} \right) - a_{i,j+1} \left( b_{i+1,j+1} - b_{i-1,j+1} \right) + a_{i,j-1} \left( b_{i+1,j-1} - b_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>C: <div class="math notranslate nohighlight">
\[\frac 1 {d^2} \left[ \left( a_{i+1/2,j} - a_{i-1/2,j} \right) \left( b_{i,j+1/2} - b_{i,j-1/2} \right) -    \left( a_{i,j+1/2} - a_{i,j-1/2} \right) \left( b_{i+1/2,j} - b_{i-1/2,j} \right) \right]\]</div>
</p></li>
<li><p>D: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ b_{i+1,j} \left( a_{i+1,j+1} - a_{i+1,j-1} \right) - b_{i-1,j} \left( a_{i-1,j+1} - a_{i-1,j-1} \right) - b_{i,j+1} \left( a_{i+1,j+1} - a_{i-1,j+1} \right) + b_{i,j-1} \left( a_{i+1,j-1} - a_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>E: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ a_{i+1,j+1} \left( b_{i+1,j+1} - b_{i+1,j-1} \right) - a_{i-1,j-1} \left( b_{i-1,j+1} - b_{i-1,j-1} \right) - a_{i+1,j+1} \left( b_{i+1,j+1} - b_{i-1,j+1} \right) + a_{i-1,j-1} \left( b_{i+1,j-1} - b_{i-1,j-1} \right) \right]\]</div>
</p></li>
<li><p>F: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ \left( a_{i+1,j} - a_{i-1,j} \right) \left( b_{i,j+1} - b_{i,j-1} \right) -    \left( a_{i,j+1} - a_{i,j-1} \right) \left( b_{i+1,j} - b_{i-1,j} \right) \right]\]</div>
</p></li>
<li><p>G: <div class="math notranslate nohighlight">
\[\frac 1 {4d^2} \left[ b_{i,j+1} \left( a_{i+1,j+1} - a_{i-1,j+1} \right) - b_{i,j-1} \left( a_{i+1,j-1} - a_{i-1,j-1} \right) - b_{i+1,j} \left( a_{i+1,j+1} - a_{i+1,j-1} \right) + b_{i-1,j} \left( a_{i-1,j+1} - a_{i-1,j-1} \right) \right]\]</div>
</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                       
</pre></div>
</div>
<p>In the following, replace ‘x’ by ‘A’, ‘B’, ‘C’, ‘D’, ‘E’, ‘F’, ‘G’, or ‘Hint’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">quiz</span><span class="o">.</span><span class="n">jacobian_3</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Acceptable answers are &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;Hint&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="boundary-conditions">
<h4>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>One question that arises immediately when applying the difference
stencils in <a class="reference external" href="#fig:stencil">Figure Stencil</a> and <a class="reference external" href="#fig:d4stencil">Figure Bi-Laplacian Stencil</a>
is</p>
<blockquote>
<div><p><em>What do we do at the boundary, where at least one of the nodes
of the difference stencil lies outside of the domain?</em></p>
</div></blockquote>
<p>The answer to this question lies with the <span><em>boundary
conditions</em></span> for <span class="math notranslate nohighlight">\(\chi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span>. We already know the boundary
conditions for <span class="math notranslate nohighlight">\(\psi\)</span> from <a class="reference external" href="#The-Quasi-Geostrophic-Model">Section The Quasi-Geostrophic Model</a>:</p>
<p>Free slip:</p>
<blockquote>
<div><p>The free slip boundary condition, <span class="math notranslate nohighlight">\(\psi=0\)</span>, is applied when <span class="math notranslate nohighlight">\(A_h=0\)</span>,
which we can differentiate with respect to time to get the identical
condition <span class="math notranslate nohighlight">\(\chi=0\)</span>. In terms of the discrete unknowns, this
translates to the requirement that
<div class="math notranslate nohighlight">
\[\Psi_{0,j} = \Psi_{N,j} = \Psi_{i,0} = \Psi_{i,N} = 0 \;\;
\mbox{ for} \; i,j = 0,1,\ldots,N,\]</div>
</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  
</pre></div>
</div>
<blockquote>
<div><p>and similarly for <span class="math notranslate nohighlight">\(\chi\)</span>. All
boundary values for <span class="math notranslate nohighlight">\(\chi\)</span> and <span class="math notranslate nohighlight">\(\Psi\)</span> are known, and so we need only
apply the difference stencils at <em>interior points</em> (see
<a class="reference external" href="#fig:ghost">Figure Ghost Points</a>). When <span class="math notranslate nohighlight">\(A_h=0\)</span>, the high-order viscosity
term is not present, and so the only stencil appearing in the
discretization is the 5-point formula (the significance of this will
become clear when we look at no-slip boundary conditions).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/ghost3.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;50%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_35_0.png" src="../../../../../../_images/01-lab_8_35_0.png" />
</div>
</div>
<div id='fig:ghost'>
**Figure Ghost Points:**
The points on the computational grid, which are classified into
    interior, real boundary, and ghost boundary points. The 5- and
    13-point difference stencils, when overlaid on the grid, demonstrate
    that only the real boundary values are needed for the free-slip
    boundary values (when $A_h=0$), while ghost points must be
    introduced for the no-slip conditions (when $A_h\neq 0$, and the
    higher order viscosity term is present).
</div><p>No-slip:</p>
<blockquote>
<div><p>The no-slip conditions appear when <span class="math notranslate nohighlight">\(A_h\neq 0\)</span>, and include the free
slip conditions <span class="math notranslate nohighlight">\(\psi=\chi=0\)</span> (which we already discussed above),
and the normal derivative condition <span class="math notranslate nohighlight">\(\nabla\psi\cdot\hat{n}=0\)</span>,
which must be satisfied at all boundary points. It is clear that if
we apply the standard, second-order centered difference
approximation to the first derivative, then the difference stencil
extends <em>beyond the boundary of the domain and contains at
least one non-existent point! How can we get around this
problem?</em></p>
</div></blockquote>
<blockquote>
<div><p>The most straightforward approach (and the one we will use in this
Lab) is to introduce a set of <em>fictitious points</em> or
<em>ghost points</em>,</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<blockquote>
<div><p><div class="math notranslate nohighlight">
\[\Psi_{-1,j}, \;\; \Psi_{N+1,j}, \;\; \Psi_{i,-1}, \;\; \Psi_{i,N+1}\]</div>
</p>
</div></blockquote>
<blockquote>
<div><p>for <span class="math notranslate nohighlight">\(i,j=0,1,2,\ldots,N+1\)</span>, which extend one grid space outside of
the domain, as shown in <a class="reference external" href="#fig:ghost">Figure Ghost Points</a>. We can then
discretize the Neumann condition in a straightforward manner. For
example, consider the point <span class="math notranslate nohighlight">\((0,1)\)</span>, pictured in
<a class="reference external" href="#fig:noslip">Figure No Slip Boundary Condition</a>, at which the discrete version of
<span class="math notranslate nohighlight">\(\nabla\psi\cdot\hat{n}=0\)</span> is</p>
</div></blockquote>
<blockquote>
<div><p><div class="math notranslate nohighlight">
\[\frac{1}{2d} ( \Psi_{1,1} - \Psi_{-1,1}, \Psi_{0,2} -
\Psi_{0,0} ) \cdot (-1,0) = 0,\]</div>
</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  
</pre></div>
</div>
<blockquote>
<div><p>(where <span class="math notranslate nohighlight">\((-1,0)\)</span> is the unit
outward normal vector), which simplifies to</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<blockquote>
<div><p><div class="math notranslate nohighlight">
\[\Psi_{-1,1} = \Psi_{1,1}.\]</div>
</p>
</div></blockquote>
<blockquote>
<div><p>The same can be done for all the
remaining ghost points: the value of <span class="math notranslate nohighlight">\(\Psi\)</span> at at point outside the
boundary is given quite simply as the value at the corresponding
interior point reflected across the boundary.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/noslip.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_37_0.png" src="../../../../../../_images/01-lab_8_37_0.png" />
</div>
</div>
<div id="fig:noslip">
**Figure No Slip Boundary Condition:**
The discrete Neumann boundary conditions are discretized using
    ghost points. Here, at point $(0,1)$, the unit outward normal vector
    is $\hat{n}=(-1,0)$, and the discrete points involved are the four
    points circled in red. The no-slip condition simply states that
    $\Psi_{-1,1}$ is equal to the interior value $\Psi_{1,1}$.
</div><p>Now, remember that when <span class="math notranslate nohighlight">\(A_h\neq 0\)</span>, the <span class="math notranslate nohighlight">\(\nabla_h^4\psi\)</span> term
appears in the equations, which is discretized as a 13-point
stencil . Looking at <a class="reference external" href="#fig:ghost">Figure Ghost Points</a>, it is easy to see that
when the 13-point stencil is applied at points adjacent to the
boundary (such as <span class="math notranslate nohighlight">\((N-1,N-1)\)</span> in the Figure) it involves not only
real boundary points, but also ghost boundary points (compare this
to the 5-point stencil). But, as we just discovered above, the
presence of the ghost points in the stencil poses no difficulty,
since these values are known in terms of interior values of <span class="math notranslate nohighlight">\(\Psi\)</span>
using the boundary conditions.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Just as there are many Runge-Kutta schemes, there are many finite difference stencils for the different derivatives.
For example, one could use a 5-point, <span class="math notranslate nohighlight">\(\times\)</span>-shaped stencil for <span class="math notranslate nohighlight">\(\nabla^2\psi\)</span>. The flexibility of
having several second-order stencils is what makes it possible to determine an energy- and enstrophy-conserving scheme for the Jacobian which we do later.</p>
<p>A good discussion of boundary conditions is given by <a class="reference external" href="#Ref:McCalpin">McCalpin</a> in his
QGBOX code documentation, on page 44.</p>
</div>
<div class="section" id="matrix-form-of-the-discrete-equations">
<h4>Matrix Form of the Discrete Equations<a class="headerlink" href="#matrix-form-of-the-discrete-equations" title="Permalink to this headline">¶</a></h4>
<p>In order to write the discrete equations  in matrix form, we must first
write the unknown values <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span> in vector form. The most obvious
way to do this is to traverse the grid (see
<a class="reference external" href="#Spatial-Grid">Figure Spatial Grid</a>), one row at a time, from left to right,
leaving out the known, zero boundary values, to obtain the ordering:
<div class="math notranslate nohighlight">
\[
\vec{\chi} =
\left(\chi_{1,1},\chi_{2,1},\dots,\chi_{N-1,1},
\chi_{1,2},\chi_{2,2},\dots,\chi_{N-1,2}, \dots, \right. 
\left.\chi_{N-1,N-2},
\chi_{1,N-1},\chi_{2,N-1},\dots,\chi_{N-1,N-1}\right)^T\]</div>
</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>and similarly for <span class="math notranslate nohighlight">\(\vec{F}\)</span>. The resulting matrix (with this ordering of
unknowns) results in a matrix of the form given in
<a class="reference external" href="#fig:matrix">Figure Matrix</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/matrix.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_40_0.png" src="../../../../../../_images/01-lab_8_40_0.png" />
</div>
</div>
<div id='fig:matrix'>
**Figure Matrix:** The matrix form for the discrete Laplacian. The 5 diagonals (displayed
in blue and red) represent the non-zero values in the matrix $-$ all
other values are zero.
</div><p>The diagonals with the 1’s (pictured in red) contain some zero entries
due to the boundary condition <span class="math notranslate nohighlight">\(u=0\)</span>. Notice how similar this matrix
appears to the <em>tridiagonal matrix</em> in the Problems from
Lab 3, which arose in the discretization of the second derivative in a
boundary value problem. The only difference here is that the Laplacian
has an additional second derivative with respect to <span class="math notranslate nohighlight">\(y\)</span>, which is what
adds the additional diagonal entries in the matrix.</p>
<p>Before you think about running off and using Gaussian elimination (which
was reviewed in Lab 3), think about the size of the matrix you would
have to solve. If <span class="math notranslate nohighlight">\(N\)</span> is the number of grid points, then the matrix is
size <span class="math notranslate nohighlight">\(N^2\)</span>-by-<span class="math notranslate nohighlight">\(N^2\)</span>. Consequently, Gaussian elimination will require on
the order of <span class="math notranslate nohighlight">\(N^6\)</span> operations to solve the matrix only once. Even for
moderate values of <span class="math notranslate nohighlight">\(N\)</span>, this cost can be prohibitively expensive. For
example, taking <span class="math notranslate nohighlight">\(N=101\)</span> results in a <span class="math notranslate nohighlight">\(10000\times 10000\)</span> system of
linear equations, for which Gaussian elimination will require on the
order of <span class="math notranslate nohighlight">\(10000^3=10^{12}\)</span> operations! As mentioned in Lab 3, direct
methods are not appropriate for large sparse systems such as this one. A
more appropriate choice is an iterative or <em>relaxation
scheme</em>, which is the subject of the next section..</p>
</div>
</div>
<div class="section" id="solution-of-the-poisson-equation-by-relaxation">
<h3>Solution of the Poisson Equation by Relaxation<a class="headerlink" href="#solution-of-the-poisson-equation-by-relaxation" title="Permalink to this headline">¶</a></h3>
<p>One thing to notice about the matrix in <a class="reference external" href="#fig:matrix">Figure Matrix</a> is that
it contains many zeros. Direct methods, such as Gaussian elimination
(GE), are so inefficient for this problem because they operate on all of
these zero entries (in fact, there are other direct methods that exploit
the sparse nature of the matrix to reduce the operation count, but none
are as efficient as the methods we will talk about here).</p>
<p>However, there is another class of solution methods, called
<em>iterative methods</em> (refer to Lab 3) which are natural
candidates for solving such sparse problems. They can be motivated by
the fact that since the discrete equations are only approximations of
the PDE to begin with, <em>why should we bother computing an exact
solution to an approximate problem?</em> Iterative methods are based
on the notion that one sets up an iterative procedure to compute
successive approximations to the solution <span class="math notranslate nohighlight">\(-\)</span> approximations that get
closer and closer to the exact solution as the iteration proceeds, but
never actually reach the exact solution. As long as the iteration
converges and the approximate solution gets to within some tolerance of
the exact solution, then we are happy! The cost of a single iterative
step is designed to depend on only the number of non-zero elements in
the matrix, and so is considerably cheaper than a GE step. Hence, as
long as the iteration converges in a “reasonable number” of steps, then
the iterative scheme will outperform GE.</p>
<p>Iterative methods are also know as <em>relaxation methods</em>, of
which the <em>Jacobi method</em> is the simplest. Here are the
basic steps in the Jacobi iteration (where we’ve dropped the time
superscript <span class="math notranslate nohighlight">\(p\)</span> to simplify the notation):</p>
<ol>
<li><p>Take an initial guess, <span class="math notranslate nohighlight">\(\chi_{i,j}^{(0)}\)</span>. Let <span class="math notranslate nohighlight">\(n=0\)</span>.</p></li>
<li><p>For each grid point <span class="math notranslate nohighlight">\((i,j)\)</span>, compute the <em>residual
vector</em> <div class="math notranslate nohighlight">
\[ R_{i,j}^{(n)} = F_{i,j} - \nabla^2\chi^{(n)}_{i,j} \]</div>

<div class="math notranslate nohighlight">
\[ = F_{i,j} - \frac{1}{d^2} ( \chi_{i+1,j}^{(n)} + \chi_{i,j+1}^{(n)} + \chi_{i-1,j}^{(n)} +\chi_{i,j-1}^{(n)} - 4 \chi_{i,j}^{(n)} )\]</div>
 (which is non-zero unless <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span> is the
exact solution).</p>
<p>You should not confuse the relaxation iteration index (superscript
<span class="math notranslate nohighlight">\(\,^{(n)}\)</span>) with the time index (superscript <span class="math notranslate nohighlight">\(\,^p\)</span>). Since the
relaxation iteration is being performed at a single time step, we’ve
dropped the time superscript for now to simplify notation. Just
remember that all of the discrete values in the relaxation are
evaluated at the current time level <span class="math notranslate nohighlight">\(p\)</span>.</p>
</li>
<li><p>“Adjust” <span class="math notranslate nohighlight">\(\chi_{i,j}^{(n)}\)</span>, (leaving the other neighbours
unchanged) so that <span class="math notranslate nohighlight">\(R_{i,j}^{(n)}=0\)</span>. That is, replace
<span class="math notranslate nohighlight">\(\chi_{i,j}^{(n)}\)</span> by whatever you need to get a zero residual. This
replacement turns out to be:
<div class="math notranslate nohighlight">
\[\chi_{i,j}^{(n+1)} = \chi_{i,j}^{(n)} - \frac{d^2}{4} R_{i,j}^{(n)},\]</div>
 which defines the iteration.</p></li>
<li><p>Set <span class="math notranslate nohighlight">\(n\leftarrow n+1\)</span>, and repeat steps 2 &amp; 3 until the residual is
less than some tolerance value. In order to measure the size of the
residual, we use a <em>relative maximum norm</em> measure,
which says
<div class="math notranslate nohighlight">
\[d^2 \frac{\|R_{i,j}^{(n)}\|_\infty}{\|\chi_{i,j}^{(n)}\|_\infty} &lt; TOL\]</div>

where <div class="math notranslate nohighlight">
\[\|R_{i,j}^{(n)}\|_\infty = \max_{i,j} |R_{i,j}^{(n)}|\]</div>
 is
the <em>max-norm</em> of <span class="math notranslate nohighlight">\(R_{i,j}\)</span>, or the maximum value of
the residual on the grid (there are other error tolerances we could
use but this is one of the simplest and most effective). Using this
measure for the error ensures that the residual remains small
<em>relative</em> to the solution, <span class="math notranslate nohighlight">\(\chi_{i,j}\)</span>. A typical
value of the tolerance that might be used is <span class="math notranslate nohighlight">\(TOL=10^{-4}\)</span>.</p></li>
</ol>
<p>There are a few <strong>important things</strong> to note about the
basic relaxation procedure outlined above</p>
<ul>
<li><p>This Jacobi method is the simplest form of relaxation. It requires
that you have two storage vectors, one for <span class="math notranslate nohighlight">\(\chi_{i,j}^{(n)}\)</span> and
one for <span class="math notranslate nohighlight">\(\chi_{i,j}^{(n+1)}\)</span>.</p></li>
<li><p>The relaxation can be modified by using a single vector to store the
<span class="math notranslate nohighlight">\(\chi\)</span> values. In this case, as you compute the residual vector and
update <span class="math notranslate nohighlight">\(\chi\)</span> at each point <span class="math notranslate nohighlight">\((i,j)\)</span>, the residual involves some
<span class="math notranslate nohighlight">\(\chi\)</span> values from the previous iteration and some that have already
been updated. For example, if we traverse the grid by rows (that is,
loop over <span class="math notranslate nohighlight">\(j\)</span> first and then <span class="math notranslate nohighlight">\(i\)</span>), then the residual is now given by
<div class="math notranslate nohighlight">
\[R_{i,j}^{(n)} = F_{i,j} - \frac{1}{d^2} ( \chi_{i+1,j}^{(n)} +
\chi_{i,j+1}^{(n)} + 
\underbrace{\chi_{i-1,j}^{(n+1)} +
\chi_{i,j-1}^{(n+1)}}_{\mbox{{updated already}}} - 4
\chi_{i,j}^{(n)} ),\]</div>
 (where the <span class="math notranslate nohighlight">\((i,j-1)\)</span> and <span class="math notranslate nohighlight">\((i-1,j)\)</span> points
have already been updated), and then the solution is updated
<div class="math notranslate nohighlight">
\[\chi_{i,j}^{(n+1)} = \chi_{i,j}^{(n)} - \frac{d^2}{4}
R_{i,j}^{(n)}.\]</div>
 Not only does this relaxation scheme save on
storage (since only one solution vector is now required), but it
also converges more rapidly (typically, it takes half the number of
iterations as Jacobi), which speeds up convergence somewhat, but
still leaves the cost at the same order as Jacobi, as we can see
from <a class="reference external" href="#tab:cost">Cost of Schemes Table</a>. This is known as the
<em>Gauss-Seidel</em> relaxation scheme.</p></li>
<li><p>In practice, we actually use a modification of Gauss-Seidel
<div class="math notranslate nohighlight">
\[\chi_{i,j}^{(n+1)} = \chi_{i,j}^{(n)} - \frac{\mu d^2}{4}
R_{i,j}^{(n)}\]</div>
 where <span class="math notranslate nohighlight">\(1&lt;\mu&lt;2\)</span> is the <em>relaxation
parameter</em>. The resulting scheme is called <em>successive
over-relaxation</em>, or <em>SOR</em>, and it improves
convergence considerably (see <a class="reference external" href="#tab:cost">Cost of Schemes Table</a>.</p>
<p>What happens when <span class="math notranslate nohighlight">\(0&lt;\mu&lt;1\)</span>? Or <span class="math notranslate nohighlight">\(\mu&gt;2\)</span>? The first case is called
<em>under-relaxation</em>, and is useful for smoothing the
solution in multigrid methods. The second leads to an iteration that
never converges.</p>
</li>
<li><p><em>Does the iteration converge?</em> For the Poisson problem,
yes, but not in general.</p></li>
</ul>
<ul>
<li><p><em>How fast does the iteration converge?</em> and <em>How
much does each iteration cost?</em> The answer to both of these
questions gives us an idea of the cost of the relaxation procedure …</p>
<p>Assume we have a grid of size <span class="math notranslate nohighlight">\(N\times N\)</span>. If we used Gaussian
elimination to solve this matrix system (with <span class="math notranslate nohighlight">\(N^2\)</span> unknowns), we
would need to perform on the order of <span class="math notranslate nohighlight">\(N^6\)</span> operations (you saw this
in Lab #3). One can read in any numerical linear algebra textbook
(<a class="reference external" href="#Ref:Strang">Strang 1988,</a> for example), that the number of iterations
required for Gauss-Seidel and Jacobi is on the order of <span class="math notranslate nohighlight">\(N^3\)</span>, while
for SOR it reduces to <span class="math notranslate nohighlight">\(N^2\)</span>. There is another class of iterative
methods, called <em>multigrid methods</em>, which converge in
a constant number of iterations (the optimal result)</p>
<p>If you look at the arithmetic operations performed in the the
relaxation schemes described above, it is clear that a single
iteration involves on the order of <span class="math notranslate nohighlight">\(N^2\)</span> operations (a constant
number of multiplications for each point).</p>
<p>Putting this information together, the cost of each iterative scheme
can be compared as in <a class="reference external" href="#tab:cost">Cost of Schemes Table</a>.</p>
</li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Order of Cost</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td>Gaussian Elimination</td>
<td><span class="math notranslate nohighlight">\(N^6\)</span></td>
</tr>
<tr class="row-odd"><td>Jacobi</td>
<td><span class="math notranslate nohighlight">\(N^5\)</span></td>
</tr>
<tr class="row-even"><td>Gauss-Seidel</td>
<td><span class="math notranslate nohighlight">\(N^5\)</span></td>
</tr>
<tr class="row-odd"><td>SOR</td>
<td><span class="math notranslate nohighlight">\(N^4\)</span></td>
</tr>
<tr class="row-even"><td>Multigrid</td>
<td><span class="math notranslate nohighlight">\(N^2\)</span></td>
</tr>
</tbody>
</table>
<div id='tab:cost'>
    **Cost of Schemes Table:** Cost of iterative schemes compared to direct methods.</div><ul class="simple">
<li><p>Multigrid methods are obviously the best, but are also
<em>extremely complicated</em> … we will stick to the much
more manageable Jacobi, Gauss-Seidel and SOR schemes.</p></li>
<li><p>There are other methods (called conjugate gradient and capacitance
matrix methods) which improve on the relaxation methods we’ve seen.
These won’t be described here.</p></li>
</ul>
</div>
<div class="section" id="temporal-discretization">
<h3>Temporal Discretization<a class="headerlink" href="#temporal-discretization" title="Permalink to this headline">¶</a></h3>
<p>Let us now turn to the time evolution equation for the stream function.
Supposing that the initial time is <span class="math notranslate nohighlight">\(t=0\)</span>, then we can approximate the
solution at the discrete time points <span class="math notranslate nohighlight">\(t_p = p\Delta t\)</span>, and write the
discrete solution as <div class="math notranslate nohighlight">
\[\Psi_{i,j}^p \approx \psi(x_i,y_j,t_p).\]</div>
 Notice
that the spatial indices appear as subscripts and the time index as a
superscript on the discrete approximation <span class="math notranslate nohighlight">\(\chi\)</span>.</p>
<p>We can choose any discretization for time that we like, but for the QG
equation, it is customary (see <a class="reference external" href="#Ref:MesingerArakawa">Mesinger and Arakawa</a>, for
example) to use a centered time difference to approximate the derivative
in :
<div class="math notranslate nohighlight">
\[\frac{\Psi_{i,j}^{p+1} - \Psi_{i,j}^{p-1}}{2\Delta t} = \chi_{i,j}^p\]</div>

or, after rearranging,</p>
<p><a name='leapfrog'></a>
(Leapfrog Eqn)
<div class="math notranslate nohighlight">
\[
\Psi_{i,j}^{p+1} = \Psi_{i,j}^{p-1} + 2\Delta t \chi_{i,j}^p
\]</div>

This time differencing method is called the
<em>leap frog scheme</em>, and was introduced in Lab 7. A
pictorial representation of this scheme is given in
<a class="reference external" href="#fig:leap-frog">Figure Leap-Frog Scheme</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/leapfrog.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_47_0.png" src="../../../../../../_images/01-lab_8_47_0.png" />
</div>
</div>
<div id='fig:leap-frog'>
**Figure Leap-Frog Scheme:** A pictorial representation of the “leap-frog” character of the
time-stepping scheme. The values of $\chi$ at even time steps are linked
together with the odd $\Psi$ values; likewise, values of $\chi$ at odd
time steps are linked to the even $\Psi$ values.
</div><p>There are two additional considerations related to the time
discretization:</p>
<ul>
<li><p>The viscous terms (<span class="math notranslate nohighlight">\(\nabla_h^2\psi\)</span> and <span class="math notranslate nohighlight">\(\nabla_h^4\psi\)</span>) are
evaluated at the <span class="math notranslate nohighlight">\(p-1\)</span> time points, while all other terms in the
right hand side are evaluated at <span class="math notranslate nohighlight">\(p\)</span> points. The reasoning for this
is described in <a class="reference external" href="#Ref:McCalpin">McCalpin’s</a> QGBOX
documentation [p. 8]:</p>
<blockquote>
<div><p>Note that the frictional terms are all calculated at the old
<span class="math notranslate nohighlight">\((n-1)\)</span> time level, and are therefore first-order accurate in
time. This ’time lagging’ is necessary for linear computational
stability.</p>
</div></blockquote>
</li>
<li><p>This second item <em>will not be implemented in this lab or the
problems</em>, but should still be kept in mind …</p>
<p>The leap-frog time-stepping scheme has a disadvantage in that it
introduces a “computational mode” …  <a class="reference external" href="#Ref:McCalpin">McCalpin</a> [p. 23]
describes this as follows:</p>
<blockquote>
<div><p><em>Leap-frog models are plagued by a phenomenon called the
“computational mode”, in which the odd and even time levels become
independent. Although a variety of sophisticated techniques have
been developed for dealing with this problem, McCalpin’s model
takes a very simplistic approach. Every <em>narg</em> time
steps, adjacent time levels are simply averaged together (where
<em>narg</em><span class="math notranslate nohighlight">\(\approx 100\)</span> and odd)</em></p>
</div></blockquote>
<p>Why don’t we just abandon the leap-frog scheme? Well, <a class="reference external" href="#Ref:MesingerArakawa">Mesinger and Arakawa</a> [p. 18] make the following observations
regarding the leap-frog scheme:</p>
<ul class="simple">
<li><p>its advantages: simple and second order accurate; neutral within
the stability range.</p></li>
<li><p>its disadvantages: for non-linear equations, there is a tendency
for slow amplification of the computational mode.</p></li>
<li><p>the usual method for suppressing the spurious mode is to insert
a step from a two-level scheme occasionally (or, as McCalpin
suggests, to occasionally average the solutions at successive
time steps).</p></li>
<li><p>In Chapter 4, they mention that it is possible to construct
grids and/or schemes with the same properties as leap-frog and
yet the computational mode is absent.</p></li>
</ul>
<p>The important thing to get from this is that when integrating for
long times, the computational mode will grow to the point where it
will pollute the solution, unless one of the above methods is
implemented. For simplicity, we will not be worrying about this in
Lab #8.</p>
</li>
</ul>
</div>
<div class="section" id="outline-of-solution-procedure">
<h3>Outline of Solution Procedure<a class="headerlink" href="#outline-of-solution-procedure" title="Permalink to this headline">¶</a></h3>
<p>Now that we have discretized in both space and time, it is possible to
outline the basic solution procedure.</p>
<ol class="simple">
<li><p>Assume that at <span class="math notranslate nohighlight">\(t=t_p\)</span>, we know <span class="math notranslate nohighlight">\(\Psi^0, \Psi^1, \dots,
\Psi^{p-1}\)</span></p></li>
<li><p>Calculate <span class="math notranslate nohighlight">\(F_{i,j}^p\)</span> for each grid point <span class="math notranslate nohighlight">\((i,j)\)</span> (see
<a class="reference external" href="#Right-Hand-Side">Section Right Hand Side</a>). Keep in mind that the viscosity terms
(<span class="math notranslate nohighlight">\(\nabla_h^2\psi\)</span> and <span class="math notranslate nohighlight">\(\nabla_h^4\psi\)</span>) are evaluated at time level
<span class="math notranslate nohighlight">\(p-1\)</span>, while all other terms are evaluated at time level <span class="math notranslate nohighlight">\(p\)</span> (this
was discussed in <a class="reference external" href="#Temporal-Discretization">Section Temporal Discretization</a>).</p></li>
<li><p>Solve the (<a class="reference external" href="#eq:discrete-chi">Discrete <span class="math notranslate nohighlight">\(\chi\)</span> equation</a>) for <span class="math notranslate nohighlight">\(\chi_{i,j}^p\)</span> (the actual
solution method will be described in <a class="reference external" href="#Solution-of-the-Poisson-Equation-by-Relaxation">Section Solution of the Poisson Equation by Relaxation</a>.</p></li>
<li><p>Given <span class="math notranslate nohighlight">\(\chi_{i,j}^p\)</span>, we can find <span class="math notranslate nohighlight">\(\Psi_{i,j}^{p+1}\)</span> by using the
(<a class="reference external" href="#leapfrog">Leap-frog time stepping scheme</a>)</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(p \leftarrow p+1\)</span> and return to step 2.</p></li>
</ol>
<p>Notice that step 1 requires a knowledge of two starting values, <span class="math notranslate nohighlight">\(\Psi^0\)</span>
and <span class="math notranslate nohighlight">\(\Psi^1\)</span>, at the initial time. An important addition to the
procedure below is some way to get two starting values for <span class="math notranslate nohighlight">\(\Psi\)</span>. Here
are several alternatives:</p>
<ul class="simple">
<li><p>Set <span class="math notranslate nohighlight">\(\Psi^0\)</span> and <span class="math notranslate nohighlight">\(\Psi^1\)</span> both to zero.</p></li>
<li><p>Set <span class="math notranslate nohighlight">\(\Psi^0=0\)</span>, and then use a forward Euler step to find <span class="math notranslate nohighlight">\(\Psi^1\)</span>.</p></li>
<li><p>Use a predictor-corrector step, like that employed in Lab 7.</p></li>
</ul>
</div>
<div class="section" id="problem-two">
<h3>Problem Two<a class="headerlink" href="#problem-two" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Now that you’ve seen how the basic
numerical scheme works, it’s time to jump into the numerical scheme. The
code has already been written for the discretization described above,
with free-slip boundary conditions and the SOR relaxation scheme. The
code is in <strong>qg.py</strong> and the various functions are:</p>
</div></blockquote>
<blockquote>
<div><p><strong>main</strong>
:   the main routine, contains the time-stepping and the output.</p>
</div></blockquote>
<blockquote>
<div><p><strong>param()</strong>
:   sets the physical parameters of the system.</p>
</div></blockquote>
<blockquote>
<div><p><strong>numer_init()</strong>
:   sets the numerical parameters.</p>
</div></blockquote>
<blockquote>
<div><p><strong>vis(psi, nx, ny)</strong>
:   calculates the second order (<span class="math notranslate nohighlight">\(\nabla^2\)</span>) viscosity term (not
leap-frogged).</p>
</div></blockquote>
<blockquote>
<div><p><strong>wind(psi, nx, ny)</strong>
:   calculates the the wind term.</p>
</div></blockquote>
<blockquote>
<div><p><strong>mybeta(psi, nx, ny)</strong>
:   calculates the beta term</p>
</div></blockquote>
<blockquote>
<div><p><strong>jac(psi, vis, nx, ny)</strong>
:   calculate the Jacobian term. (Arakawa Jacobian given here).</p>
</div></blockquote>
<blockquote>
<div><p><strong>chi(psi, vis_curr, vis_prev, chi_prev, nx, ny, dx, r_coeff, tol, max_count, epsilon, wind_par, vis_par)</strong>
:   calculates <span class="math notranslate nohighlight">\(\chi\)</span> using a call to relax</p>
</div></blockquote>
<blockquote>
<div><p><strong>relax(rhs, chi_prev, dx, nx, ny, r_coeff, tol, max_count)</strong>
:   does the relaxation.</p>
</div></blockquote>
<blockquote>
<div><p>Your task in this problem is to program the “straightforward”
discretization of the Jacobian term, using <a class="reference external" href="#eq:jacob1">(Jacobian: Expansion 1)</a>, that you derived in
<a class="reference external" href="#Problem-One">Problem One</a>. The only change this involves is
inserting the code into the function <strong>jac</strong>. Once
finished, run the code. The parameter functions <strong>param</strong>
<strong>init_numer</strong> provide some sample parameter values for you to
execute the code with. Try these input values and observe what happens
in the solution. Choose one of the physical parameters to vary. Does
changing the parameter have any effect on the solution? in what way?</p>
</div></blockquote>
<blockquote>
<div><p>Hand in the code for the Jacobian, and a couple of plots demonstrating
the solution as a function of parameter variation. Describe your results
and make sure to provide parameter values to accompany your explanations
and plots.</p>
</div></blockquote>
<blockquote>
<div><p>If the solution is unstable, check your CFL condition. The relevant
waves are Rossby waves with wave speed: <div class="math notranslate nohighlight">
\[c=\beta k^{-2}\]</div>
 where <span class="math notranslate nohighlight">\(k\)</span> is
the wave-number. The maximum wave speed is for the longest wave,
<span class="math notranslate nohighlight">\(k=\pi/b\)</span> where <span class="math notranslate nohighlight">\(b\)</span> is the size fo your domain.</p>
</div></blockquote>
<blockquote>
<div><p>If the code is still unstable, even though the CFL is satisfied, see
<a class="reference external" href="#Aliasing-Error-and-Nonlinear-Instability">Section Aliasing Error and Nonlinear Instability</a>. The solution is nonlinear unstable.
Switch to the Arakawa Jacobian for stability.</p>
</div></blockquote>
</div>
<div class="section" id="problem-three">
<h3>Problem Three<a class="headerlink" href="#problem-three" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The code provided for <a class="reference external" href="#Problem-Two">Problem Two</a> implements the SOR relaxation
scheme. Your job in this problem is to modify the relaxation code to
perform a Jacobi iteration.</p>
</div></blockquote>
<blockquote>
<div><p>Hand in a comparison of the two methods, in tabular form. Use two
different relaxation parameters for the SOR scheme. (Include a list of
the physical and numerical parameter you are using). Also submit your
code for the Jacobi relaxation scheme.</p>
</div></blockquote>
</div>
<div class="section" id="problem-four">
<h3>Problem Four<a class="headerlink" href="#problem-four" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Modify the code to implement the no-slip boundary
conditions.</p>
</div></blockquote>
</div>
<div class="section" id="problem-five">
<h3>Problem Five<a class="headerlink" href="#problem-five" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The code you’ve been working with so far uses the
simplest possible type of starting values for the unknown stream
function: both are set to zero. If you’re keen to play around with the
code, you might want to try modifying the SOR code for the two other
methods of computing starting values: using a forward Euler step, or a
predictor-corrector step (see <a class="reference external" href="#Outline-of-Solution-Procedure">Section Outline of Solution Procedure</a>).</p>
</div></blockquote>
</div>
</div>
<div class="section" id="aliasing-error-and-nonlinear-instability">
<h2>Aliasing Error and Nonlinear Instability<a class="headerlink" href="#aliasing-error-and-nonlinear-instability" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference external" href="#Problem-Two">Problem Two</a>, you encountered an example
of the instability that can occur when computing numerical solutions to
some <em>nonlinear problems</em>, of which the QG equations is
just one example. This effect has in fact been known for quite some
time. Early numerical experiments by <a class="reference external" href="#Ref:Phillips">N. Phillips in 1956</a>
exploded after approximately 30 days of integration due to nonlinear
instability. He used the straightforward centered difference formula for
as you did.</p>
<p>It is important to realize that this instability does not occur in the
physical system modeled by the equations of motion. Rather is an
artifact of the discretization process, something known as
<em>aliasing error</em>. Aliasing error can be best understood by
thinking in terms of decomposing the solution into modes. In brief,
aliasing error arises in non-linear problems when a numerical scheme
amplifies the high-wavenumber modes in the solution, which corresponds
physically to a spurious addition of energy into the system. Regardless
of how much the grid spacing is reduced, the resulting computation will
be corrupted, since a significant amount of energy is present in the
smallest resolvable scales of motion. This doesn’t happen for every
non-linear problem or every difference scheme, but is an issue that one
who is using numerical codes must be aware of.</p>
<div class="section" id="example-one">
<h3>Example One<a class="headerlink" href="#example-one" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Before moving on to how we can handle the
instability in our discretization of the QG equations, you should try
out the following demo on aliasing error. It is taken from an example in
<a class="reference external" href="#Ref:MesingerArakawa">Mesinger and Arakawa</a> [p. 35ff.], based on the simplest
of non-linear PDE’s, the advection equation:
<div class="math notranslate nohighlight">
\[\frac{du}{dt}+u\frac{du}{dx} = 0.\]</div>
 If we decompose the solution into
Fourier mode, and consider a single mode with wavenumber <span class="math notranslate nohighlight">\(k\)</span>,
<div class="math notranslate nohighlight">
\[u(x) = \sin{kx}\]</div>
 then the solution will contain additional modes, due
to the non-linear term, and given by
<div class="math notranslate nohighlight">
\[u \frac{du}{dx} = k \sin{kx} \cos{kx} =\frac{1}{2}k \sin{2kx}.\]</div>
</p>
</div></blockquote>
<blockquote>
<div><p>With this as an introduction, keep the following in mind while going
through the demo:</p>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>on a computational grid with spacing <span class="math notranslate nohighlight">\(\Delta x\)</span>, the discrete
versions of the modes can only be resolved up to a maximum
wavenumber, <span class="math notranslate nohighlight">\(k_{max}=\frac{\pi}{\Delta x}\)</span>.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>even if we start with modes that are resolvable on the grid, the
non-linear term introduces modes with a higher wavenumber, which may
it not be possible to resolve. These modes, when evaluated at
discrete points, appear as modes with lower wavenumber; that is,
they are <em>aliased</em> to the lower modes (this becomes
evident in the demo as the wavenumber is increased …).</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>not only does aliasing occur, but for this problem, these additional
modes are <em>amplified</em> by a factor of <span class="math notranslate nohighlight">\(\frac{1}{2}k\)</span>.
This is the source of the <em>aliasing error</em> – such
amplified modes will grow in time, no matter how small the time step
taken, and will pollute the computations.</p></li>
</ul>
</div></blockquote>
<p>The previous example is obviously a much simpler non-linearity than that
of the QG equations, but the net effect is the same. The obvious
question we might ask now is:</p>
<blockquote>
<div><p><em>Can this problem be averted for our discretization of the QG
equations with the leap-frog time-stepping scheme, or do we have to
abandon it?</em></p>
</div></blockquote>
<p>There are several possible solutions, presented by <a class="reference external" href="#Ref:MesingerArakawa">Mesinger and Arakawa</a> [p. 37], summarized here, including</p>
<ul class="simple">
<li><p>filter out the top half or third of the wavenumbers, so that the
aliasing is eliminated.</p></li>
<li><p>use a differencing scheme that has a built-in damping of the
shortest wavelengths.</p></li>
<li><p>the most elegant, and one that allows us to continue using the
leap-frog time stepping scheme, is one suggested by Arakawa, is one
that aims to eliminate the spurious inflow of energy into the system
by developing a discretization of the Jacobian term that satisfies
discrete analogues of the conservation properties for average
vorticity, enstrophy and kinetic energy.</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>This third approach will be the one we take here. The details can be
found in the Mesinger-Arakawa paper, and are not essential here; the
important point is that there is a discretization of the Jacobian that
avoids the instability problem arising from aliasing error. This
discrete Jacobian is called the <em>Arakawa Jacobian</em> and is
obtained by averaging the discrete Jacobians obtained by using standard
centered differences on the formulae <a class="reference external" href="#eq:jacob1">(Jacobian: Expansion 1)</a>, <a class="reference external" href="#eq:jacob2">(Jacobian: Expansion 2)</a> and <a class="reference external" href="#eq:jacob3">(Jacobian: Expansion 3)</a> (see
<a class="reference external" href="#Problem-One">Problem One</a> and the two quizzes following it in
<a class="reference external" href="#Right-Hand-Side">Section Right Hand Side</a>.</p>
<p>You will not be required to derive or code the Arakawa Jacobian (the
details are messy!), and the code will be provided for you for all the
problems following <a class="reference external" href="#Problem-Two">Problem Two</a>.</p>
</div>
</div>
<div class="section" id="classical-solutions">
<h2>Classical Solutions<a class="headerlink" href="#classical-solutions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="#Ref:Bryan">Bryan (1963)</a> and <a class="reference external" href="#Ref:Veronis">Veronis (1966)</a></p>
<div class="section" id="problem-six">
<h3>Problem Six<a class="headerlink" href="#problem-six" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Using the SOR code from
Problems <a class="reference external" href="#Problem-Three">Three</a> (free-slip BC’s) and <a class="reference external" href="#Problem-Four">Four</a>
(no-slip BC’s), try to reproduce the classical results of Bryan and
Veronis.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="mathematical-notes">
<h2>Mathematical Notes<a class="headerlink" href="#mathematical-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="definition-of-the-beta-plane">
<h3>Definition of the Beta-plane<a class="headerlink" href="#definition-of-the-beta-plane" title="Permalink to this headline">¶</a></h3>
<p>A <span class="math notranslate nohighlight">\(\beta\)</span>-plane is a plane approximation of a curved section of the
Earth’s surface, where the Coriolis parameter, <span class="math notranslate nohighlight">\(f(y)\)</span>, can be written
roughly as a linear function of <span class="math notranslate nohighlight">\(y\)</span> <div class="math notranslate nohighlight">
\[f(y) = f_0 + \beta y\]</div>
 for <span class="math notranslate nohighlight">\(f_0\)</span>
and <span class="math notranslate nohighlight">\(\beta\)</span> some constants. The motivation behind this approximation
follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/coriolis.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;30%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_61_0.png" src="../../../../../../_images/01-lab_8_61_0.png" />
</div>
</div>
<div id='fig:globe'>
**Figure Rotating Globe:**
A depiction of the earth and its angular frequency of rotation,
$\Omega$, the local planetary vorticity vector in blue, and the Coriolis
parameter, $f_0$, at a latitude of $\theta_0$.
</div><p>Consider a globe (the earth) which is rotating with angular frequency
<span class="math notranslate nohighlight">\(\Omega\)</span> (see <a class="reference external" href="#fig:globe">Figure Rotating Globe</a>),
and assume that the patch of ocean under consideration is at latitude
<span class="math notranslate nohighlight">\(\theta\)</span>. The most important component of the Coriolis force is the
local vertical (see the in <a class="reference external" href="#fig:globe">Figure Rotating Globe</a>), which is defined in
terms of the Coriolis parameter, <span class="math notranslate nohighlight">\(f\)</span>, to be <div class="math notranslate nohighlight">
\[f/2 = \Omega \sin\theta.\]</div>

This expression may be simplified somewhat by ignoring curvature effects
and approximating the earth’s surface at this point by a plane <span class="math notranslate nohighlight">\(-\)</span> if
the plane is located near the middle latitudes, then this is a good
approximation. If <span class="math notranslate nohighlight">\(\theta_0\)</span> is the latitude at the center point of the
plane, and <span class="math notranslate nohighlight">\(R\)</span> is the radius of the earth (see
<a class="reference external" href="#fig:globe">Figure Rotating Globe</a>), then we can apply trigonometric ratios to
obtain the following expression on the plane:
<div class="math notranslate nohighlight">
\[f = \underbrace{2\Omega\sin\theta_0}_{f_0} +
\underbrace{\frac{2\Omega\cos\theta_0}{R}}_\beta \, y\]</div>
 Not
surprisingly, this plane is called a <em>mid-latitude
<span class="math notranslate nohighlight">\(\beta\)</span>-plane</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/beta-plane.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;30%&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/01-lab_8_63_0.png" src="../../../../../../_images/01-lab_8_63_0.png" />
</div>
</div>
<div id='fig:beta'>
**Figure Beta-plane:**
The $\beta$-plane approximation, with points on the plane located
along the local $y$-axis. The Coriolis parameter, $f$, at any latitude
$\theta$, can be written in terms of $y$ using trigonometric
ratios.</div></div>
<div class="section" id="simplification-of-the-qg-model-equations">
<h3>Simplification of the QG Model Equations<a class="headerlink" href="#simplification-of-the-qg-model-equations" title="Permalink to this headline">¶</a></h3>
<p>The first approximation we will make eliminates several of the
non-linear terms in the set of equations: (<a class="reference external" href="#eq:xmom">X-Momentum Eqn</a>), (<a class="reference external" href="#eq:ymom">Y-Momentum Eqn</a>), (<a class="reference external" href="#eq:hydrostatic">Hydrostatic Eqn</a>) and (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>). A common simplification that is made in
this type of flow is the <em>quasi-geostrophic</em> (QG)
approximation, where the horizontal pressure gradient and horizontal
components of the Coriolis force are matched:
<div class="math notranslate nohighlight">
\[fv \approx \frac{1}{\rho} \, \frac {\partial p}{\partial x}, \, \, fu \approx - \,\frac{1}{\rho}
\, \frac{\partial p}{\partial y} .\]</div>

Remembering that the fluid is homogeneous (the density is
constant), (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) implies
<div class="math notranslate nohighlight">
\[\frac{\partial^2 p}{\partial x\partial z} = 0, \, \, \frac{\partial^2 p}{\partial y\partial z} = 0.\]</div>
 We can
then differentiate the QG balance equations to obtain
<div class="math notranslate nohighlight">
\[\frac{\partial v}{\partial z} \approx 0, \, \, \frac{\partial u}{\partial z} \approx 0.\]</div>
 Therefore, the terms
<span class="math notranslate nohighlight">\(w \, \partial u/\partial z\)</span> and <span class="math notranslate nohighlight">\(w \, \partial v/\partial z\)</span> can be neglected in (<a class="reference external" href="#eq:xmom">(X-Momentum Eqn)</a>) and
(<a class="reference external" href="#eq:ymom">(Y-Momentum Eqn)</a>).</p>
<p>The next simplification is to eliminate the pressure terms in
(<a class="reference external" href="#eq:xmom">(X-Momentum Eqn)</a>) and
(<a class="reference external" href="#eq:ymom">(Y-Momentum Eqn)</a>) by cross-differentiating. If we define
the vorticity <div class="math notranslate nohighlight">
\[\zeta = \partial v/\partial x - \partial u/\partial y\]</div>
 then we can
cross-differentiate the two momentum equations and replace them with a
single equation in <span class="math notranslate nohighlight">\(\zeta\)</span>:
<div class="math notranslate nohighlight">
\[\frac{\partial \zeta}{\partial t} + u \frac{\partial \zeta}{\partial x} + v \frac{\partial \zeta}{\partial y} + v\beta + (\zeta+f)(\frac {\partial u}{\partial x}+\frac{\partial v}{\partial y}) =
A_v \, \frac{\partial^2 \zeta}{\partial z^2} + A_h \, \nabla_h^2 \zeta,\]</div>
 where
<span class="math notranslate nohighlight">\(\beta \equiv df/dy\)</span>. Notice the change in notation for derivatives,
from <span class="math notranslate nohighlight">\(\nabla\)</span> to <span class="math notranslate nohighlight">\(\nabla_h\)</span>: this indicates that derivative now appear
only with respect to the “horizontal” coordinates, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, since
the <span class="math notranslate nohighlight">\(z\)</span>-dependence in the solution has been eliminated.</p>
<p>The third approximation we will make is to assume that vorticity effects
are dominated by the Coriolis force, or that <span class="math notranslate nohighlight">\(|\zeta| \ll f\)</span>. Using
this, along with the (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) implies that</p>
<p><a name='eq:diff'></a>
(Vorticity Eqn)
<div class="math notranslate nohighlight">
\[\frac{\partial \zeta}{\partial t} + u \frac {\partial \zeta}{\partial x} + v \frac{\partial \zeta}{\partial y} + v \beta -f \, \frac{\partial w}{\partial z} = A_v \,
\frac{\partial^2 \zeta}{\partial z^2} + A_h \, \nabla_h^2 \zeta .\]</div>

The reason for
making this simplification may not be obvious now but it is a good
approximation in flows in the ocean and, as we will see next, it allows
us to eliminate the Coriolis term.</p>
<p>The final sequence of simplifications eliminate the <span class="math notranslate nohighlight">\(z\)</span>-dependence in
the problem by integrating (<a class="reference external" href="#eq:diff">Vorticity Eqn</a>) in the vertical direction and using boundary
conditions.</p>
<p>The top 500 metres of the ocean tend to act as a single slab-like layer.
The effect of stratification and rotation cause mainly horizontal
motion. To first order, the upper layers are approximately averaged flow
(while to the next order, surface and deep water move in opposition with
deep flow much weaker). Consequently, our averaging over depth takes
into account this “first order” approximation embodying the horizontal
(planar) motion, and ignoring the weaker (higher order) effects.</p>
<p>First, recognize that the vertical component of velocity on both the top
and bottom surfaces should be zero: $<span class="math notranslate nohighlight">\(w = 0 \;\;\; \mbox{at \)</span>z=0<span class="math notranslate nohighlight">\(}\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(w = 0 \;\;\; \mbox{at \)</span>z=-H<span class="math notranslate nohighlight">\(}\)</span><span class="math notranslate nohighlight">\( Notice that the in second
condition we’ve also assumed that the water surface is approximately
flat \)</span>-<span class="math notranslate nohighlight">\( this is commonly known as the *rigid lid
approximation*. Integrate the differential equation ([Vorticity Eqn](#eq:diff)) with respect
to \)</span>z<span class="math notranslate nohighlight">\(, applying the above boundary conditions, and using the fact that
\)</span>u<span class="math notranslate nohighlight">\( and \)</span>v<span class="math notranslate nohighlight">\( (and therefore also \)</span>\zeta<span class="math notranslate nohighlight">\() are independent of \)</span>z$,</p>
<p><a name='vort-depth-integ'></a>
(Depth-Integrated Vorticity)
<div class="math notranslate nohighlight">
\[
\frac{1}{H} \int_{-H}^0 \mbox{(Vorticity Eqn)} dz \Longrightarrow 
\frac {\partial \zeta}{\partial t} + u \frac {\partial \zeta}{\partial x} + v \frac {\partial \zeta}{\partial y} + v\beta 
= \frac{1}{H} \, \left( \left. A_v \, 
\frac{\partial \zeta}{\partial z} \right|_{z=0} - \left.  A_v \, 
\frac{\partial \zeta}{\partial z} \right|_{z=-H} \right) \, + A_h \, \nabla_h^2 \zeta
\]</div>
</p>
<p>The two boundary terms on the right hand side can be rewritten in terms
of known information if we apply two additional boundary conditions: the
first, that the given wind stress on the ocean surface,
<div class="math notranslate nohighlight">
\[\vec{\tau}(x,y) = (\tau_1,\tau_2) \;\;\mbox{at }\;\; z=0,\]</div>
 can be
written as
<div class="math notranslate nohighlight">
\[\rho A_v \left( \frac{\partial u}{\partial z} , \frac{\partial v}{\partial z} \right) = \left( \tau_1 , \tau_2
\right)\]</div>
 which, after differentiating, leads to</p>
<p><a name='eq:stressbc'></a>
(Stress Boundary Condition)
<div class="math notranslate nohighlight">
\[\frac{1}{H} \, A_v \, \left. \frac{\partial \zeta}{\partial z} \right|_{z=0} = \frac{1}{\rho H} \,
\nabla_h \times \tau \,;
\]</div>
 and, the second, that the <em>Ekman
layer</em> along the bottom of the ocean, <span class="math notranslate nohighlight">\(z=-H\)</span>, generates Ekman
pumping which obeys the following relationship:</p>
<p><a name='ekmanbc'></a>
(Ekman Boundary Condition)
<div class="math notranslate nohighlight">
\[\frac{1}{H} \, A_v \, \left. \frac{\partial \zeta}{\partial z} \right|_{z=-H} =
\; \kappa \zeta, 
\]</div>
 where the <em>Ekman number</em>,
<span class="math notranslate nohighlight">\(\kappa\)</span>, is defined by
<div class="math notranslate nohighlight">
\[\kappa \equiv  \frac{1}{H}  \left( \frac{A_v f}{2} \right)^{1/2}.\]</div>

Using (<a class="reference external" href="#eq:stressbc">Stress Boundary Condition</a>) and (<a class="reference external" href="#ekmanbc">Ekman Boundary Condition</a>) to replace the boundary terms in (<a class="reference external" href="#vort-depth-integ">Depth-Integrated Vorticity</a>), we get the following
equation for the vorticity:
<div class="math notranslate nohighlight">
\[\frac{\partial \zeta}{\partial t} + u \frac{\partial \zeta}{\partial x} + v \frac{\partial \zeta}{\partial y} + v \beta = \frac{1}{\rho H} \, \nabla_h 
\times \tau - \kappa \zeta + A_h \, \nabla_h^2 \zeta.\]</div>
</p>
<p>The next and final step may not seem at first to be much of a
simplification, but it is essential in order to derive a differential
equation that can be easily solved numerically. Integrate (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) with respect
to <span class="math notranslate nohighlight">\(z\)</span> in order to obtain <div class="math notranslate nohighlight">
\[\frac {\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0,\]</div>
 after which we can
introduce a <em>stream function</em>, <span class="math notranslate nohighlight">\(\psi\)</span>, defined in terms of
the velocity as
<div class="math notranslate nohighlight">
\[u = - \, \frac{\partial \psi}{\partial y} \, , \, v = \frac{\partial \psi}{\partial x}.\]</div>
 The
stream function satisfies this equation exactly, and we can write the
vorticity as <div class="math notranslate nohighlight">
\[\zeta = \nabla_h^2 \psi,\]</div>
 which then allows us to write
both the velocity and vorticity in terms of a single variable, <span class="math notranslate nohighlight">\(\psi\)</span>.</p>
<p>After substituting into the vorticity equation, we are left with a
single equation in the unknown stream function. <div class="math notranslate nohighlight">
\[
\frac{\partial}{\partial t} \, \nabla_h^2 \psi + {\cal J} \left( \psi, \nabla_h^2 \psi \right) + \beta \, \frac {\partial \psi}{\partial x} = \frac{-1}{\rho H} \, \nabla_h \times \tau  - \, \kappa \, \nabla_h^2 \psi + A_h \, \nabla_h^4 \psi \]</div>

where
<div class="math notranslate nohighlight">
\[{\cal J} (a,b) = \frac{\partial a}{\partial x} \, \frac{\partial b}{\partial y} - \frac{\partial a}{\partial y} \, \frac{\partial b}{\partial x}\]</div>
 is called the <em>Jacobian</em> operator.</p>
<p>The original system (<a class="reference external" href="#eq:xmom">X-Momentum Eqn</a>), (<a class="reference external" href="#eq:ymom">Y-Momentum Eqn</a>), (<a class="reference external" href="#eq:hydrostatic">Hydrostatic Eqn</a>) and (<a class="reference external" href="#eq:continuity">Continuity Eqn</a>) was a system of four non-linear PDE’s, in four
independent variables (the three velocities and the pressure), each of
which depend on the three spatial coordinates. Now let us review the
approximations made above, and their effects on this system:</p>
<ol class="simple">
<li><p>After applying the QG approximation and homogeneity, two of the
non-linear terms were eliminated from the momentum equations, so
that the vertical velocity, <span class="math notranslate nohighlight">\(w\)</span>, no longer appears.</p></li>
<li><p>By introducing the vorticity, <span class="math notranslate nohighlight">\(\zeta\)</span>, the pressure was eliminated,
and the two momentum equations to be rewritten as a single equation
in <span class="math notranslate nohighlight">\(\zeta\)</span> and the velocities.</p></li>
<li><p>Some additional terms were eliminated by assuming that Coriolis
effects dominate vorticity, and applying the continuity condition.</p></li>
<li><p>Integrating over the vertical extent of the ocean, and applying
boundary conditions eliminated the <span class="math notranslate nohighlight">\(z\)</span>-dependence in the problem.</p></li>
<li><p>The final step consists of writing the unknown vorticity and
velocities in terms of the single unknown stream function, <span class="math notranslate nohighlight">\(\psi\)</span>.</p></li>
</ol>
<p>It is evident that the final equation is considerably simpler: it is a
single, non-linear PDE for the unknown stream function, <span class="math notranslate nohighlight">\(\psi\)</span>, which is
a function of only two independent variables. As we will see in the next
section, this equation is of a very common type, for which simple and
efficient numerical techniques are available.</p>
</div>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>advection:</strong> A property or quantity transferred by the flow of a fluid is said to be “advected” by the flow.
aliasing error: In a numerical scheme, this is the phenomenon that occurs when a grid is not fine enough to resolve the high modes in a solution. These high waveumbers consequently appear as lower modes in the solution due to aliasing. If the scheme is such that these high wavenumber modes are amplified, then the aliased modes can lead to a significant error in the computed solution.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\(\beta\)</span>-plane:</strong> A <span class="math notranslate nohighlight">\(\beta\)</span>-plane is a plane approximation of a curved section of the Earth’s surface, where the Coriolis parameter can be written roughly as a linear function.</p></li>
<li><p><strong>continuity equation:</strong> The equation that describes mass conservation in a fluid, <span class="math notranslate nohighlight">\({\partial \rho}/{\partial t} + \nabla \cdot (\rho \vec u) = 0\)</span></p></li>
<li><p><strong>Coriolis force:</strong> An additional force experienced by an observer positioned in a rotating frame of reference. If <span class="math notranslate nohighlight">\(\Omega\)</span> is the angular velocity of the rotating frame, and <span class="math notranslate nohighlight">\(\vec u\)</span> is the velocity of an object observed within the rotating frame, then the Coriolis force, <span class="math notranslate nohighlight">\(\Omega \times \vec u\)</span>, appears as a force tending to deflect the moving object to the right.</p></li>
<li><p><strong>Coriolis parameter:</strong> The component of the planetary vorticity which is normal to the earth’s surface, usually denoted by f.</p></li>
<li><p><strong>difference stencil:</strong> A convenient notation for representing difference approximation formula for derivatives.</p></li>
<li><p><strong>Ekman layer:</strong> The frictional layer in a geophysical fluid flow field which appears on a rigid surface perpendicular to the rotation vector.</p></li>
<li><p><strong>Gauss-Seidel relaxation:</strong> One of a class of iterative schemes for solving systems of linear equations. See Lab 8 for a complete discussion.</p></li>
<li><p><strong>homogeneous fluid:</strong> A fluid with constant density. Even though the density of ocean water varies with depth, it is often assumed homogeneous in order to simplify the equations of motion.</p></li>
<li><p><strong>hydrostatic balance:</strong> A balance, in the vertical direction, between the vertical pressure gradient and the buoyancy force. The pressure difference between any two points on a vertical line is assumed to depend only on the weight of the fluid between the points, as if the fluid were at rest, even though it is actually in motion. This approximation leads to a simplification in the equations of fluid flow, by replacing the vertical momentum equation.</p></li>
<li><p><strong>incompressible fluid:</strong> A fluid for which changes in the density with pressure are negligible. For a fluid with velocity field, <span class="math notranslate nohighlight">\(\vec u\)</span>, this is expressed by the equation <span class="math notranslate nohighlight">\(\nabla \cdot \vec u = 0\)</span>. This equation states that the local increase of density with time must be balanced by the divergence of the mass flux.</p></li>
<li><p><strong>Jacobi relaxation:</strong> The simplest of the iterative methods for solving linear systems of equations. See Lab 8 for a complete discussion.</p></li>
<li><p><strong>momentum equation(s):</strong> The equations representing Newton’s second law of motion for a fluid. There is one momentum equation for each component of the velocity.</p></li>
<li><p><strong>over-relaxation:</strong> Within a relaxation scheme, this refers to the use of a relaxation parameter <span class="math notranslate nohighlight">\(\mu &gt; 1\)</span>. It accelerates the standard Gauss-Seidel relaxation by forcing the iterates to move closer to the actual solution.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Poisson equation:</strong> The partial differential equation <span class="math notranslate nohighlight">\(\nabla^2 u = f\)</span> or, written two dimensions, <span class="math notranslate nohighlight">\({\partial^2 u}/{\partial x^2} + {\partial^2 u}/{\partial y^2} =f(x,y)\)</span>.</p></li>
<li><p><strong>QG:</strong> abbreviation for quasi-geostrophic.</p></li>
<li><p><strong>quasi-geostrophic balance:</strong> Approximate balance between the pressure gradient and the Coriolis Force.</p></li>
<li><p><strong>relaxation:</strong> A term that applies to a class of iterative schemes for solving large systems of equations. The advantage to these schemes for sparse matrices (compared to direct schemes such as Gaussian elimination) is that they operate only on the non-zero entries of the matrix. For a description of relaxation methods, see Lab 8.</p></li>
</ul>
<ul class="simple">
<li><p><strong>rigid lid approximation:</strong> Assumption that the water surface deflection is negligible in the continuity equation (or conservation of volume equation)</p></li>
<li><p><strong>SOR:</strong> see successive over-relaxation.</p></li>
<li><p><strong>sparse system:</strong> A system of linear equations whose matrix representation has a large percentage of its entries equal to zero.</p></li>
<li><p><strong>stream function:</strong> Incompressible, two-dimensional flows with velocity field <span class="math notranslate nohighlight">\((u,v)\)</span>, may be described by a stream function, <span class="math notranslate nohighlight">\(\psi(x, y)\)</span>, which satisfies <span class="math notranslate nohighlight">\(u = −{\partial \psi}/{\partial y}, v = {\partial \psi}/{\partial x}\)</span>. These equations are a consequence of the incompressibility condition.</p></li>
<li><p><strong>successive over-relaxation:</strong> An iterative method for solving large systems of linear equations. See Lab 8 for a complete discussion.</p></li>
<li><p><strong>under-relaxation:</strong> Within a relaxation scheme, this refers to the use of a relaxation parameter <span class="math notranslate nohighlight">\(\mu &lt; 1\)</span>. It is not appropriate for solving systems of equations directly, but does have some application to multigrid methods.</p></li>
<li><p><strong>vorticity:</strong> Defined to be the curl of the velocity field, <span class="math notranslate nohighlight">\(\zeta = \nabla \times \vec u\)</span>. In geophysical flows, where the Earth is a rotating frame of reference, the vorticity can be considered as the sum of a relative vorticity (the curl of the velocity in the nonrotating frame) and the planetary vorticity, <span class="math notranslate nohighlight">\(2 \Omega\)</span>. For these large-scale flows, vorticity is almost always present, and the planetary vorticity dominates.</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div id='Ref:ArakawaLamb'>
Arakawa, A. and V. R. Lamb, 1981: A potential enstrophy and energy conserving scheme for the shallow water equations. Monthly Weather Review, 109, 18–36.
</div>
<div id="Ref:Bryan">
Bryan, K., 1963: A numerical investigation of a non-linear model of a wind-driven ocean. Journal of Atmospheric Science, 20, 594–606</div>
<div id="Ref:McCalpin">
On the adjustment of azimuthally perturbed vortices. Journal of Geophysical Research, 92, 8213–8225.
</div>
<div id="Ref:MesingerArakawa">
Mesinger, F. and A. Arakawa, 1976: Numerical Methods Used in Atmospheric Models,GARP Publications Series No.~17, Global Atmospheric Research Programme.
</div>
<div id="Ref:Pedlosky">
Pedlosky, J., 1987: Geophysical Fluid Dynamics. Springer-Verlag, New York, 2nd edition.Pond, 
</div>
<div id="Ref:Phillips">
Phillips, N. A., 1956: The general circulation of the atmosphere: A numerical experiment.
Quarterly Journal of the Royal Meteorological Society, 82, 123–164.
</div>
<div id="Ref:Strang">
Strang, G., 1988: Linear Algebra and its Applications. Harcourt Brace Jovanovich, San Diego,
CA, 2nd edition.
</div>
<div id="Ref:Veronis">
Veronis, G., 1966: Wind-driven ocean circulation – Part 2. Numerical solutions of the non- linear problem. Deep Sea Research, 13, 31–55.
</div></div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Numeric project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>